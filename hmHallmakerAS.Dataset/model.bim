{
  "compatibilityLevel": 1567,
  "model": {
    "annotations": [
      {
        "name": "__PBI_TimeIntelligenceEnabled",
        "value": "0"
      },
      {
        "name": "PBIDesktopVersion",
        "value": "2.119.986.0 (23.07)"
      },
      {
        "name": "PBI_QueryOrder",
        "value": "[\"CompanyId\",\"CompanyName\",\"SisteAar\",\"AntallAar\",\"Kontoplan\",\"Kalender\",\"Prosjekt\",\"HpPrognose\",\"Faktorer\",\"Regnskap\",\"NyeKontoer\",\"ProPrognose\",\"Sample File Parameter1\",\"Transform Sample File from ProPrognose\",\"Sample File\",\"Transform File from ProPrognose\",\"ProsjektKPI\",\"ProsjektStatus\",\"ProsjektMeasures\",\"WorkInProgress\",\"SP_ProNummerEndring\",\"Sample File Parameter2\",\"Transform Sample File from ProNummerEndring\",\"Sample File (2)\",\"Transform File from ProNummerEndring\",\"Eyeshare\",\"Leverandører\",\"Kunder\",\"Betalinger\",\"SQLserver1\",\"SQLdatabase1\",\"SharePointSite1\",\"Selskap\",\"GetLastDateGL\",\"LastDateGL\",\"ForecastFromForecast\",\"SQL_Company\",\"SQL_Forecast\",\"SQL_Suppliers\",\"SQL_Projects\",\"SQL_Customers\",\"SQL_ChartOfAccounts\",\"SQL_ReportingCOA\",\"SQL_CustomersAccounts\",\"SQL_GeneralLedger\",\"SQL_EyeShare\",\"SQL_Budget\",\"DatesFromForecast\",\"DatesFromProjects\",\"ProjectForecast\",\"ProjectRevenueForecast\",\"ProjectCostForecast\",\"fn_cumulative_revenue\",\"fn_cumulative_cost\",\"SQL_ProjectMgrs\",\"LiveProjectForecast\",\"RegnskapHistFromMergers\",\"SQL_ProjectFromMergers\",\"AccountFromMergers\"]"
      },
      {
        "name": "__TEdtr",
        "value": "1"
      },
      {
        "name": "PBI_ProTooling",
        "value": "[\"DevMode\"]"
      }
    ],
    "culture": "nb-NO",
    "cultures": [
      {
        "name": "nb-NO",
        "linguisticMetadata": {
          "content": {
            "DynamicImprovement": "HighConfidence",
            "Entities": {
              "betalinger.bilagsnummer": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "Betalinger",
                    "ConceptualProperty": "BilagsNummer"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Fakturanummer": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "betalinger.utgfakturanok": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "Betalinger",
                    "ConceptualProperty": "UtgFakturaNOK"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Fakturabeløp (eks mva)": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "hpprognose.dgproggraf": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "HpPrognose",
                    "ConceptualProperty": "DGprogGraf"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "DG (%)": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "hpprognose.inntproggraf": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "HpPrognose",
                    "ConceptualProperty": "InntProgGraf"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Inntekt": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "hpprognose.kostproggraf": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "HpPrognose",
                    "ConceptualProperty": "KostProgGraf"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Kostnad": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "liveprojectforecast.costadj": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "LiveProjectForecast",
                    "ConceptualProperty": "CostAdj"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Justering": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "liveprojectforecast.livestage": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "LiveProjectForecast",
                    "ConceptualProperty": "LiveStage"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Status": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjekt.dp_beskrivelse": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "Prosjekt",
                    "ConceptualProperty": "DP Beskrivelse"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Kostnadsspesifikasjon:": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  },
                  {
                    "Delprosjekter": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.inntekt": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "Inntekt"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Opptjent": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.kostnadsbudsjett": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "Kostnadsbudsjett"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Kalkyle": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  },
                  {
                    "Salgskalkyle": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.kostnadsprognose": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "Kostnadsprognose"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Prognose": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.prodgindikator": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "ProDGIndikator"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.progvsbud": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "ProgVsBud"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Avvik": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.proinntektindikator": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "ProInntektIndikator"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.påløpt": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "Påløpt"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Forbruk": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektkpi.rest": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektKPI",
                    "ConceptualProperty": "Rest"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Gjennstående": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektmeasures.fakturabeløp": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektMeasures",
                    "ConceptualProperty": "Fakturabeløp"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Beløp": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              },
              "prosjektmeasures.kostakk": {
                "Definition": {
                  "Binding": {
                    "ConceptualEntity": "ProsjektMeasures",
                    "ConceptualProperty": "KostAkk"
                  }
                },
                "State": "Generated",
                "Terms": [
                  {
                    "Bokført": {
                      "Source": {
                        "Agent": "PowerBI.VisualColumnRename",
                        "Type": "External"
                      },
                      "State": "Suggested",
                      "Weight": 0.9
                    }
                  }
                ]
              }
            },
            "Language": "en-US",
            "Version": "2.0.0"
          },
          "contentType": "json"
        }
      }
    ],
    "dataAccessOptions": {
      "legacyRedirects": true,
      "returnErrorValuesAsNull": true
    },
    "defaultPowerBIDataSourceVersion": "powerBI_V3",
    "expressions": [
      {
        "name": "CompanyId",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Number"
          }
        ],
        "expression": "2 meta [IsParameterQuery=true, List={1, 2, 3, 4, 5}, DefaultValue=..., Type=\"Number\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "1aaf99de-3a9a-442c-bacf-24146d8b5eba",
        "queryGroup": "Parametere"
      },
      {
        "name": "CompanyName",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigasjon"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "expression": "\"Linto AS\" meta [IsParameterQuery=true, List={\"Hallmaker AS\", \"Byggservice AS\", \"Linto AS\", \"Rubb AS\", \"Utleie AS\"}, DefaultValue=..., Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "4e3b57a2-3bd8-4c70-ae5c-c5267d50b6ef",
        "queryGroup": "Parametere"
      },
      {
        "name": "SisteAar",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigasjon"
          },
          {
            "name": "PBI_ResultType",
            "value": "Number"
          }
        ],
        "expression": "2023 meta [IsParameterQuery=true, Type=\"Number\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "fd0776db-0363-4a99-aba2-a02517a77501",
        "queryGroup": "Parametere"
      },
      {
        "name": "AntallAar",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Number"
          }
        ],
        "expression": "5 meta [IsParameterQuery=true, Type=\"Number\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "4de62ca3-4f7c-4eb8-9a3f-2c71fced9b32",
        "queryGroup": "Parametere"
      },
      {
        "name": "Sample File Parameter1",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Binary"
          }
        ],
        "expression": "#\"Sample File\" meta [IsParameterQuery=true, BinaryIdentifier=#\"Sample File\", Type=\"Binary\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "37608113-1b54-49ae-82d5-1c8da39a2833",
        "queryGroup": "Transform File from ProPrognose\\Sample Query"
      },
      {
        "name": "Transform Sample File from ProPrognose",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = Excel.Workbook(#\"Sample File Parameter1\", null, true),",
          "    #\"Expanded Data\" = Table.ExpandTableColumn(Source, \"Data\", {\"Column1\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"Column6\"}, {\"Column1\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"Column6\"}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Data\",{\"Item\", \"Kind\", \"Hidden\"}),",
          "    #\"Added Custom\" = Table.AddColumn(#\"Removed Columns\", \"Custom\", each if [Column1] = \"ProsjektId\" then \"Version\" else [Name]),",
          "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Added Custom\",{\"Name\"}),",
          "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Removed Columns1\", [PromoteAllScalars=true]),",
          "    #\"Filtered Rows\" = Table.SelectRows(#\"Promoted Headers\", each ([ProsjektId] <> null and [ProsjektId] <> \"ProsjektId\")),",
          "    #\"Added Custom1\" = Table.AddColumn(#\"Filtered Rows\", \"Date\", each if Text.Contains([Version], \"_\") then Text.AfterDelimiter([Version], \"_\") else [Version]),",
          "    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"Custom\", each if Text.Contains([Version], \"_\") then Text.BeforeDelimiter([Version], \"_\") else null),",
          "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Added Custom2\",{\"Beskrivelse\", \"Version\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Custom\", \"Version\"}}),",
          "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns\",null,0,Replacer.ReplaceValue,{\"Inntekter\", \"Kostnader\"}),",
          "    #\"Multiplied Column\" = Table.TransformColumns(#\"Replaced Value\", {{\"Inntekter\", each _ * -1, type number}})",
          "in",
          "    #\"Multiplied Column\""
        ],
        "kind": "m",
        "lineageTag": "e7024818-aa4d-40a7-a681-5a752d55a813",
        "queryGroup": "Transform File from ProPrognose"
      },
      {
        "name": "Sample File",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Binary"
          }
        ],
        "expression": [
          "let",
          "    Source = SharePoint.Files(\"https://hallmakergruppenas.sharepoint.com/finance/\", [ApiVersion = 15]),",
          "    #\"Filtered Rows\" = Table.SelectRows(Source, each Text.Contains([Folder Path], CompanyName)),",
          "    Navigation1 = #\"Filtered Rows\"{0}[Content]",
          "in",
          "    Navigation1"
        ],
        "kind": "m",
        "lineageTag": "f951ed0d-e420-4e63-b5e0-165b9d2d659f",
        "queryGroup": "Transform File from ProPrognose\\Sample Query"
      },
      {
        "name": "Transform File from ProPrognose",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let",
          "    Source = (#\"Sample File Parameter1\" as binary) => let",
          "    Source = Excel.Workbook(#\"Sample File Parameter1\", null, true),",
          "    #\"Expanded Data\" = Table.ExpandTableColumn(Source, \"Data\", {\"Column1\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"Column6\"}, {\"Column1\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"Column6\"}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Data\",{\"Item\", \"Kind\", \"Hidden\"}),",
          "    #\"Added Custom\" = Table.AddColumn(#\"Removed Columns\", \"Custom\", each if [Column1] = \"ProsjektId\" then \"Version\" else [Name]),",
          "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Added Custom\",{\"Name\"}),",
          "    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Removed Columns1\", [PromoteAllScalars=true]),",
          "    #\"Filtered Rows\" = Table.SelectRows(#\"Promoted Headers\", each ([ProsjektId] <> null and [ProsjektId] <> \"ProsjektId\")),",
          "    #\"Added Custom1\" = Table.AddColumn(#\"Filtered Rows\", \"Date\", each if Text.Contains([Version], \"_\") then Text.AfterDelimiter([Version], \"_\") else [Version]),",
          "    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"Custom\", each if Text.Contains([Version], \"_\") then Text.BeforeDelimiter([Version], \"_\") else null),",
          "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Added Custom2\",{\"Beskrivelse\", \"Version\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Custom\", \"Version\"}}),",
          "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns\",null,0,Replacer.ReplaceValue,{\"Inntekter\", \"Kostnader\"}),",
          "    #\"Multiplied Column\" = Table.TransformColumns(#\"Replaced Value\", {{\"Inntekter\", each _ * -1, type number}})",
          "in",
          "    #\"Multiplied Column\"",
          "in",
          "    Source"
        ],
        "kind": "m",
        "lineageTag": "4686baca-ff88-4bfa-9729-c89fce5bed8a",
        "queryGroup": "Transform File from ProPrognose"
      },
      {
        "name": "SP_ProNummerEndring",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "//SharePoint",
          "",
          "    SharePointFiles = SharePoint.Files(SharePointSite1, [ApiVersion = 15]),",
          "",
          "//Procedure",
          "    #\"Filtered Rows\" = Table.SelectRows(SharePointFiles, each ([Folder Path] = SharePointSite1 & \"/Shared Documents/EndringProsjektPoster/\")),",
          "    #\"Filtered Hidden Files1\" = Table.SelectRows(#\"Filtered Rows\", each [Attributes]?[Hidden]? <> true),",
          "    #\"Invoke Custom Function2\" = Table.AddColumn(#\"Filtered Hidden Files1\", \"Transform File from ProNummerEndring\", each #\"Transform File from ProNummerEndring\"([Content])),",
          "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Invoke Custom Function2\", {\"Name\", \"Source.Name\"}),",
          "    #\"Removed Other Columns2\" = Table.SelectColumns(#\"Renamed Columns3\", {\"Source.Name\", \"Transform File from ProNummerEndring\"}),",
          "    #\"Expanded Table Column2\" = Table.ExpandTableColumn(#\"Removed Other Columns2\", \"Transform File from ProNummerEndring\", Table.ColumnNames(#\"Transform File from ProNummerEndring\"(#\"Sample File (2)\"))),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Expanded Table Column2\",{{\"Source.Name\", type text}, {\"GLEntryNo\", type text}, {\"VendorId\", Int64.Type}, {\"ProjectId\", type text}}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Changed Type\",{{\"Source.Name\", \"CompanyId\"}}),",
          "    #\"Extracted Text Before Delimiter\" = Table.TransformColumns(#\"Renamed Columns\", {{\"CompanyId\", each Text.BeforeDelimiter(_, \".\"), type text}})",
          "in",
          "    #\"Extracted Text Before Delimiter\""
        ],
        "kind": "m",
        "lineageTag": "5d3df5fc-38c4-4333-8a44-3f768ba81d17",
        "queryGroup": "DataSources"
      },
      {
        "name": "Sample File Parameter2",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Binary"
          }
        ],
        "expression": "#\"Sample File (2)\" meta [IsParameterQuery=true, BinaryIdentifier=#\"Sample File (2)\", Type=\"Binary\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "57da27dd-2385-46ab-b9a4-fa52ae887650",
        "queryGroup": "Transform File from ProNummerEndring\\Sample Query"
      },
      {
        "name": "Transform Sample File from ProNummerEndring",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = Excel.Workbook(#\"Sample File Parameter2\", null, true),",
          "    #\"Filtered Rows\" = Table.SelectRows(Source, each ([Kind] = \"Table\")),",
          "    #\"Expanded Data\" = Table.ExpandTableColumn(#\"Filtered Rows\", \"Data\", {\"GLEntryNo\", \"VendorId\", \"ProjectId\"}, {\"GLEntryNo\", \"VendorId\", \"ProjectId\"}),",
          "    #\"Removed Other Columns\" = Table.SelectColumns(#\"Expanded Data\",{\"GLEntryNo\", \"VendorId\", \"ProjectId\"})",
          "in",
          "    #\"Removed Other Columns\""
        ],
        "kind": "m",
        "lineageTag": "f8a6aefb-8761-4235-b8b2-8466cda73931",
        "queryGroup": "Transform File from ProNummerEndring"
      },
      {
        "name": "Sample File (2)",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Binary"
          }
        ],
        "expression": [
          "let",
          "    Source = SharePoint.Files(SharePointSite1, [ApiVersion = 15]),",
          "    #\"Filtered Rows\" = Table.SelectRows(Source, each ([Folder Path] = SharePointSite1 & \"/Shared Documents/EndringProsjektPoster/\")),",
          "    Navigation1 = #\"Filtered Rows\"{0}[Content]",
          "in",
          "    Navigation1"
        ],
        "kind": "m",
        "lineageTag": "47fac6ab-938b-4218-b413-976f8def96c8",
        "queryGroup": "Transform File from ProNummerEndring\\Sample Query"
      },
      {
        "name": "Transform File from ProNummerEndring",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let",
          "    Source = (#\"Sample File Parameter2\" as binary) => let",
          "    Source = Excel.Workbook(#\"Sample File Parameter2\", null, true),",
          "    #\"Filtered Rows\" = Table.SelectRows(Source, each ([Kind] = \"Table\")),",
          "    #\"Expanded Data\" = Table.ExpandTableColumn(#\"Filtered Rows\", \"Data\", {\"GLEntryNo\", \"VendorId\", \"ProjectId\"}, {\"GLEntryNo\", \"VendorId\", \"ProjectId\"}),",
          "    #\"Removed Other Columns\" = Table.SelectColumns(#\"Expanded Data\",{\"GLEntryNo\", \"VendorId\", \"ProjectId\"})",
          "in",
          "    #\"Removed Other Columns\"",
          "in",
          "    Source"
        ],
        "kind": "m",
        "lineageTag": "c3d62a78-d4ec-43c4-921e-1f0250d7125c",
        "queryGroup": "Transform File from ProNummerEndring"
      },
      {
        "name": "Eyeshare",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    sqlTbl1 = SQL_EyeShare,",
          "",
          "//Procedure",
          "    #\"Changed Type\" = Table.TransformColumnTypes(sqlTbl1,{{\"FirmaId\", Int64.Type}}),",
          "    #\"Merged Queries\" = Table.NestedJoin(#\"Changed Type\",{\"FirmaId\"},SQL_Company,{\"InfoEasyId\"},\"Companies\",JoinKind.Inner),",
          "    #\"Expanded Companies\" = Table.ExpandTableColumn(#\"Merged Queries\", \"Companies\", {\"CompanyId\"}, {\"CompanyId\"}),",
          "    #\"Added Custom\" = Table.AddColumn(#\"Expanded Companies\", \"ProsjektLnk\", each if Text.Length([ProsjektId]) = 0 then null else Text.From([CompanyId])&\"-\"&Text.From([ProsjektId]),type text),",
          "    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"KontoLnk\", each if Text.Length([KontoId]) = 0 then null else Text.From([CompanyId])&\"-\"&Text.From([KontoId]),type text),",
          "    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"LevLnk\", each if Text.Length([LevId]) = 0 then null else Text.From([CompanyId])&\"-\"&Text.From([LevId]),type text),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom2\",{\"FirmaId\", \"LevId\", \"KontoId\", \"ProsjektId\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"EstNetAmount\", \"Belop2\"}, {\"EyeShare\", \"Eyeshare\"}, {\"CompanyId\", \"SelskapsId\"}}),",
          "    #\"Filtered Rows\" = Table.SelectRows(#\"Renamed Columns\", each ([ProsjektLnk] <> null))",
          "in",
          "    #\"Filtered Rows\""
        ],
        "kind": "m",
        "lineageTag": "37880ddc-22a0-45bd-b81e-d780727a1dcf",
        "queryGroup": "Hjelpetabeller"
      },
      {
        "name": "SQLserver1",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "expression": "\"a2insight.database.windows.net\" meta [IsParameterQuery=true, List={\"a2insight.database.windows.net\"}, DefaultValue=\"a2insight.database.windows.net\", Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "b224e581-9dc8-4983-8040-9165c52b6573",
        "queryGroup": "Parametere"
      },
      {
        "name": "SQLdatabase1",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "expression": "\"a2dmHallmaker\" meta [IsParameterQuery=true, List={\"a2dmHallmaker\"}, DefaultValue=\"a2dmHallmaker\", Type=\"Text\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "0e314bd8-b7fb-4b7a-9b00-5fcc08b49970",
        "queryGroup": "Parametere"
      },
      {
        "name": "SharePointSite1",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "expression": "\"https://hallmakergruppenas.sharepoint.com/sites/archive-2020-05-23T114054Z/finance\" meta [IsParameterQuery=true, List={\"https://hallmakergruppenas.sharepoint.com/finance/\", \"https://hallmakergruppenas.sharepoint.com/sites/archive-2020-05-23T114054Z/finance\"}, DefaultValue=\"https://hallmakergruppenas.sharepoint.com/sites/archive-2020-05-23T114054Z/finance\", Type=\"Any\", IsParameterQueryRequired=true]",
        "kind": "m",
        "lineageTag": "81fa93a4-03b6-468a-8a63-cf99c12967c1",
        "queryGroup": "Parametere"
      },
      {
        "name": "GetLastDateGL",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let  ",
          "  ",
          "SQLSource = (companyId as text) =>  ",
          "  ",
          "let  ",
          "  ",
          "//Source = Sql.Database(SQLserver1, SQLdatabase1, [Query=\"EXEC uspTest '\"& Text.Upper(companyId)&\"' #(lf)#(lf)#(lf)\"])  ",
          "Source = Sql.Database(SQLserver1, SQLdatabase1, [Query=\"EXEC uspTest '\"& Text.Upper(companyId)&\"'\"])  ",
          "  ",
          "in  ",
          "  ",
          "Source  ",
          "  ",
          "in  ",
          "  ",
          "SQLSource"
        ],
        "kind": "m",
        "lineageTag": "cfa287e9-9879-470f-a7c8-9a9f5ca4138b",
        "queryGroup": "Parametere"
      },
      {
        "name": "LastDateGL",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = GetLastDateGL(CompanyName),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Date\", type date}})",
          "in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "793abe06-efd9-41a0-9654-1d6dcfe3f115",
        "queryGroup": "Hjelpetabeller"
      },
      {
        "name": "ForecastFromForecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = SQL_Forecast,",
          "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Date\", type date}}),",
          "    #\"Inserted Start of Month\" = Table.AddColumn(#\"Changed Type\", \"Dato\", each Date.StartOfMonth([Date]), type date),",
          "    #\"Grouped Rows\" = Table.Group(#\"Inserted Start of Month\", {\"Hovedarbeidsprosjekt\", \"Dato\"}, {{\"Inntekter\", each List.Sum([Inntekter]), type number}, {\"Kostnader\", each List.Sum([Kostnader]), type number}}),",
          "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Grouped Rows\",{{\"Hovedarbeidsprosjekt\", type text}, {\"Dato\", type date}, {\"Inntekter\", type number}, {\"Kostnader\", type number}}),",
          "    #\"Sorted Rows1\" = Table.Sort(#\"Changed Type1\",{{\"Hovedarbeidsprosjekt\", Order.Ascending}, {\"Dato\", Order.Ascending}}),",
          "    #\"Added Index2\" = Table.AddIndexColumn(#\"Sorted Rows1\", \"Index\", 0, 1)",
          "in",
          "    #\"Added Index2\""
        ],
        "kind": "m",
        "lineageTag": "06905deb-068e-4f84-a419-da716bb028e0",
        "queryGroup": "Hjelpetabeller"
      },
      {
        "name": "SQL_Company",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"LU_Companies\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
          "    #\"Filtered Rows\" = Table.SelectRows(sqlTbl1, each [OldSelskapsId] = CompanyName)",
          "",
          "",
          "in",
          "    #\"Filtered Rows\""
        ],
        "kind": "m",
        "lineageTag": "229678f2-423f-474c-9640-f3cfec584f30",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_Forecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "   ",
          "    table1 = \"FA_ProjectForecastChanges\",",
          "    table2 = \"LU_Projects\",",
          "",
          "    sqlDatabase = Sql.Database(\"a2insight.database.windows.net\", \"a2dmHallmaker\"),",
          "",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
          "    sqlTbl2 = sqlDatabase{[Schema=\"dbo\",Item=(table2)]}[Data],",
          "    #\"Merged Queries\" = Table.NestedJoin(sqlTbl1,{\"ProjectId\"},sqlTbl2,{\"ProjectId\"},\"sqlTbl2\",JoinKind.LeftOuter),",
          "    #\"Expanded sqlTbl2\" = Table.ExpandTableColumn(#\"Merged Queries\", \"sqlTbl2\", {\"ParentProjectNo\", \"CompanyId\", \"ProjectRef\"}, {\"ParentProjectNo\", \"CompanyId\", \"ProjectRef\"}),",
          "    #\"Merged Queries1\" = Table.NestedJoin(#\"Expanded sqlTbl2\",{\"CompanyId\"},SQL_Company,{\"CompanyId\"},\"SQL_Company\",JoinKind.LeftOuter),",
          "    #\"Expanded SQL_Company\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"SQL_Company\", {\"Company\"}, {\"Company\"}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded SQL_Company\",{\"ProjectId\", \"Comments\", \"UpdatedBy\", \"UpdatedDate\", \"LineKey\", \"CompanyId\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"ParentProjectNo\", \"Hovedarbeidsprosjekt\"}, {\"ProjectRef\", \"ProsjektId\"}, {\"Cost\", \"Kostnader\"}, {\"Revenue\", \"Inntekter\"}, {\"DateId\", \"Date\"}}),",
          "    #\"Added Custom\" = Table.AddColumn(#\"Renamed Columns\", \"Version\", each null),",
          "    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"PlanStart\", each null),",
          "    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"PlanSlutt\", each null),",
          "    #\"Sorted Rows\" = Table.Sort(#\"Added Custom2\",{{\"Date\", Order.Ascending}}),",
          "    #\"Filtered Rows\" = Table.SelectRows(#\"Sorted Rows\", each ([Company] = \"Hallmaker AS\"))",
          "in",
          "    #\"Filtered Rows\""
        ],
        "kind": "m",
        "lineageTag": "6a85cee5-bb81-4802-bc2a-a2e004f30aa0",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_Suppliers",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"Leverandorer\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"pbi\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "3afdba9f-18bc-43b5-b100-304e81c8486d",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_Projects",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"Prosjekter\",",
          "    table2 = \"LU_Projects\",",
          "    table3 = \"LU_ProjectMgrs\",",
          "    table4 = \"LU_Companies\",",
          "    ",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
          "    sqlTbl2 = sqlDatabase{[Schema=\"dbo\",Item=(table2)]}[Data],",
          "    sqlTbl3 = sqlDatabase{[Schema=\"dbo\",Item=(table3)]}[Data],",
          "    sqlTbl4 = sqlDatabase{[Schema=\"dbo\",Item=(table4)]}[Data],",
          "",
          "    #\"Added Custom\" = Table.AddColumn(sqlTbl1, \"Custom\", each if [HovedArbeidProsjektNr] <> null then [HovedArbeidProsjektNr] else Text.BeforeDelimiter([ProsjektId], \"-\"), type text),",
          "    RemoveDeleted = Table.SelectRows(#\"Added Custom\", each ([Status] <> 9)),",
          "    #\"Removed Columns\" = Table.RemoveColumns(RemoveDeleted,{\"HovedArbeidProsjektNr\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"HovedArbeidProsjektNr\"}, {\"Frifelt3\", \"DG\"}, {\"KontraktSum\", \"OrdreVerdi\"}, {\"Frifelt4\", \"OrdreDato\"}, {\"FriTekst1\", \"Adresse\"}}),",
          "    ExtractFromFrifelt = Table.TransformColumns(#\"Renamed Columns\", {{\"Adresse\", each Text.AfterDelimiter(_, \" \"), type text}, {\"DG\", each Text.AfterDelimiter(_, \" \"), type text}, {\"OrdreDato\", each Text.AfterDelimiter(_, \" \"), type text}}),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(ExtractFromFrifelt,{{\"HovedArbeidProsjektNr\", type text}, {\"OrdreVerdi\", type number}, {\"DG\", Percentage.Type}, {\"OrdreDato\", type date}, {\"Adresse\", type text}}),",
          "    #\"Replaced Errors\" = Table.ReplaceErrorValues(#\"Changed Type\", {{\"DG\", null},{\"OrdreDato\", null}}),",
          "    #\"Merged Queries\" = Table.NestedJoin(#\"Replaced Errors\",{\"FirmaId\"},Table.SelectRows(sqlTbl4, each [OldSelskapsId] = CompanyName),{\"InfoEasyId\"},\"SQL_Company\",JoinKind.Inner),",
          "    #\"Expanded SQL_Company\" = Table.ExpandTableColumn(#\"Merged Queries\", \"SQL_Company\", {\"CompanyId\"}, {\"CompanyId\"}),",
          "    #\"Merged Queries1\" = Table.NestedJoin(#\"Expanded SQL_Company\",{\"ProsjektId\",\"CompanyId\"},sqlTbl2,{\"ProjectRef\",\"CompanyId\"},\"Removed Columns1\",JoinKind.LeftOuter),",
          "    #\"Expanded Removed Columns1\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Removed Columns1\", {\"DepartmentId\", \"ParentProjectNo\", \"ProjectId\", \"ProjectManagerId\", \"Status\"}, {\"DepartmentId\", \"ParentProjectNo\", \"ProjectId\", \"ProjectManagerId\", \"Status.1\"}),",
          "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Expanded Removed Columns1\",{{\"ProjectManagerId\", Int64.Type}}),",
          "    #\"Merged Queries2\" = Table.NestedJoin(#\"Changed Type2\",{\"ProjectManagerId\"},sqlTbl3,{\"ProjectMgrId\"},\"Expanded Removed Columns1\",JoinKind.LeftOuter),",
          "    #\"Expanded Expanded Removed Columns1\" = Table.ExpandTableColumn(#\"Merged Queries2\", \"Expanded Removed Columns1\", {\"NickName\", \"email\"}, {\"NickName\", \"email\"}),",
          "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Expanded Expanded Removed Columns1\",{\"Status\", \"HovedArbeidProsjektNr\", \"CompanyId\", \"ProjectManagerId\", \"Prosjektleder\", \"Avdeling\"}),",
          "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Status.1\", \"Status\"}, {\"ParentProjectNo\", \"HovedArbeidProsjektNr\"}, {\"DepartmentId\", \"Avdeling\"}}),",
          "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"ProsjektlederId\"}),",
          "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Removed Columns1\",{{\"email\", \"ProsjektlederId\"}, {\"NickName\", \"Prosjektleder\"}}),",
          "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Renamed Columns2\",{{\"ProsjektlederId\", type text}})",
          "in",
          "    #\"Changed Type1\""
        ],
        "kind": "m",
        "lineageTag": "ca80777c-b82a-432e-ba37-8038280c3464",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_Customers",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"Kunder\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"pbi\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "0e7ebb48-c791-4c1f-b17b-0b075fcdda15",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_ChartOfAccounts",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"Kontoplan\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "f0d7a0e2-68a0-43bb-a660-dce300d4fb89",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_ReportingCOA",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"KontoplanGrupper\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "c1c97abf-6ea4-4f64-9d62-6f4bea14b2ab",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_CustomersAccounts",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"KundePoster\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"pbi\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "71f35e5a-ef96-414a-bd56-11dfb5e69890",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_GeneralLedger",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"Hovedbok\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"pbi\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "4bbd862f-8a58-4aab-b8d7-1b464a4cd58b",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_EyeShare",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"EyeShare\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
          "    #\"Changed Type\" = Table.TransformColumnTypes(sqlTbl1,{{\"FirmaId\", Int64.Type}}),",
          "    #\"Grouped Rows\" = Table.Group(#\"Changed Type\", {\"FirmaId\", \"LevId\", \"FakturaId\", \"FakturaDato\", \"KontoId\", \"ProsjektId\", \"EyeShare\"}, {{\"EstNetAmount\", each List.Sum([EstNetAmount]), type number}})",
          "",
          "",
          "in",
          "    #\"Grouped Rows\""
        ],
        "kind": "m",
        "lineageTag": "29714ac2-5601-49cb-a9d5-2880ec51cc55",
        "queryGroup": "DataSources"
      },
      {
        "name": "SQL_Budget",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigasjon"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "   ",
          "table1 = \"Budget\",",
          "",
          "    sqlDatabase = Sql.Database(\"a2insight.database.windows.net\", \"a2dmHallmaker\"),",
          "",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data]",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "148f7815-ff55-47ca-991c-4c49b8747074",
        "queryGroup": "DataSources"
      },
      {
        "name": "DatesFromForecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = SQL_Forecast,",
          "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"ProsjektId\", type text}, {\"Inntekter\", type number}, {\"Kostnader\", type number}, {\"PlanStart\", type date}, {\"PlanSlutt\", type date}, {\"Date\", type date}}),",
          "    #\"Grouped Rows\" = Table.Group(#\"Changed Type\", {\"Hovedarbeidsprosjekt\"}, {{\"Start\", each List.Min([PlanStart]), type date}, {\"Slutt\", each List.Max([PlanSlutt]), type date}, {\"Dato\", each List.Min([Date]), type date}})",
          "in",
          "    #\"Grouped Rows\""
        ],
        "kind": "m",
        "lineageTag": "f8440dd4-f7df-4463-9f8b-4f96ad53a2a9",
        "queryGroup": "Hjelpetabeller"
      },
      {
        "name": "DatesFromProjects",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = Prosjekt,",
          "    AddHPFilter = Table.AddColumn(Source, \"Custom\", each if [ProsjektNummer] = [HovedArbeidProsjektNr] then 1 else 0),",
          "    FilterHovedProsjekt = Table.SelectRows(AddHPFilter, each ([Custom] = 1)),",
          "    #\"Grouped Rows\" = Table.Group(FilterHovedProsjekt, {\"HovedArbeidProsjektNr\"}, {{\"Start\", each List.Min([StartDato]), type date}, {\"Slutt\", each List.Max([PlanFerdigDato]), type date}})",
          "in",
          "    #\"Grouped Rows\""
        ],
        "kind": "m",
        "lineageTag": "9371bb60-39b1-4f72-8c53-784ad0259657",
        "queryGroup": "Hjelpetabeller"
      },
      {
        "name": "ProjectRevenueForecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = ForecastFromForecast,",
          "    #\"Removed Columns\" = Table.RemoveColumns(Source,{\"Index\"}),",
          "",
          "    Calc_Running_Total = Table.Group(",
          "                                      #\"Removed Columns\",                                                                           // table as table",
          "                                     {\"Hovedarbeidsprosjekt\"},                                                                       // key as any",
          "                                                                                                                       // aggregatedColumns as list ",
          "                                        {{\"Data\",                                                                           // name of new column to be created",
          "                                    // Function Call",
          "                                        (Input as table) as table =>                                                        // data for function",
          "                                        let",
          "                                        Call_Function = fn_cumulative_revenue(Input),",
          "                                    // End of Function Call",
          "",
          "                                        result = Table.FromColumns(                                                         // putting all together",
          "                                                                    Table.ToColumns(Input)&{Call_Function},",
          "                                                                        Value.Type(",
          "                                                                                   Table.AddColumn(",
          "                                                                                                    Input, \"Saldo\", each null, type number",
          "                                                                                                   )",
          "                                                                                )",
          "                                                                       )",
          "                                        in",
          "                                            result,",
          "",
          "",
          "                                    type table}}                                                                    // transform into table",
          "                                    ),",
          "    #\"Expanded Data\" = Table.ExpandTableColumn(Calc_Running_Total, \"Data\", {\"Dato\", \"Inntekter\", \"Saldo\"}, {\"Date\", \"Revenue\", \"RevenueAcc\"}),",
          "    ",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Expanded Data\",{{\"Hovedarbeidsprosjekt\", type text}, {\"Date\", type date}, {\"Revenue\", Int64.Type}, {\"RevenueAcc\", Int64.Type}})",
          "in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "6f2794b4-c515-4eb5-aae4-fa9806e97fb0",
        "queryGroup": "WorkInProgress"
      },
      {
        "name": "ProjectCostForecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "    Source = ForecastFromForecast,",
          "    #\"Removed Columns\" = Table.RemoveColumns(Source,{\"Index\"}),",
          "",
          "    Calc_Running_Total = Table.Group(",
          "                                      #\"Removed Columns\",                                                                           // table as table",
          "                                     {\"Hovedarbeidsprosjekt\"},                                                                       // key as any",
          "                                                                                                                       // aggregatedColumns as list ",
          "                                        {{\"Data\",                                                                           // name of new column to be created",
          "                                    // Function Call",
          "                                        (Input as table) as table =>                                                        // data for function",
          "                                        let",
          "                                        Call_Function = fn_cumulative_cost(Input),",
          "                                    // End of Function Call",
          "",
          "                                        result = Table.FromColumns(                                                         // putting all together",
          "                                                                    Table.ToColumns(Input)&{Call_Function},",
          "                                                                        Value.Type(",
          "                                                                                   Table.AddColumn(",
          "                                                                                                    Input, \"Saldo\", each null, type number",
          "                                                                                                   )",
          "                                                                                )",
          "                                                                       )",
          "                                        in",
          "                                            result,",
          "",
          "",
          "                                    type table}}                                                                    // transform into table",
          "                                    ),",
          "    #\"Expanded Data\" = Table.ExpandTableColumn(Calc_Running_Total, \"Data\", {\"Dato\", \"Kostnader\", \"Saldo\"}, {\"Date\", \"Cost\", \"CostAcc\"}),",
          "    ",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Expanded Data\",{{\"Hovedarbeidsprosjekt\", type text}, {\"Date\", type date}, {\"Cost\", Int64.Type}, {\"CostAcc\", Int64.Type}})",
          "in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "78deff2c-2306-4f9f-8ad6-23798ec313dd",
        "queryGroup": "WorkInProgress"
      },
      {
        "name": "fn_cumulative_revenue",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let ",
          "",
          "Source = (Input as table) =>",
          "",
          "let",
          "",
          "    Sorting = Table.Sort(Input,{{\"Dato\", Order.Ascending}}),",
          "    added_Index = Table.AddIndexColumn(Sorting, \"Index\", 1, 1),",
          "    cumulativ_total = Table.AddColumn(added_Index, \"Revenue\", each List.Sum(List.Range(added_Index[Inntekter],0,[Index]))),",
          "",
          "",
          "    extract_total = cumulativ_total[Revenue]",
          "    ",
          "    ",
          "in",
          "    extract_total",
          "    ",
          "in",
          "",
          "    Source"
        ],
        "kind": "m",
        "lineageTag": "22a13460-b5db-4bdc-aca3-e543fa2d584c",
        "queryGroup": "WorkInProgress"
      },
      {
        "name": "fn_cumulative_cost",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Function"
          }
        ],
        "expression": [
          "let ",
          "",
          "Source = (Input as table) =>",
          "",
          "let",
          "",
          "    Sorting = Table.Sort(Input,{{\"Dato\", Order.Ascending}}),",
          "    added_Index = Table.AddIndexColumn(Sorting, \"Index\", 1, 1),",
          "    cumulativ_total = Table.AddColumn(added_Index, \"Cost\", each List.Sum(List.Range(added_Index[Kostnader],0,[Index]))),",
          "",
          "",
          "    extract_total = cumulativ_total[Cost]",
          "    ",
          "    ",
          "in",
          "    extract_total",
          "    ",
          "in",
          "",
          "    Source"
        ],
        "kind": "m",
        "lineageTag": "8f2855d0-68a1-4558-90ba-b82bea8a1545",
        "queryGroup": "WorkInProgress"
      },
      {
        "name": "SQL_ProjectMgrs",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"LU_ProjectMgrs\",",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data]",
          "",
          "",
          "in",
          "    sqlTbl1"
        ],
        "kind": "m",
        "lineageTag": "755d5223-d0bc-485e-baf5-7f2d532e650d",
        "queryGroup": "DataSources"
      },
      {
        "name": "RegnskapHistFromMergers",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigasjon"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "//Procedure",
          "    FilterSelskap = Table.NestedJoin(SQL_GeneralLedger,{\"FirmaId\", \"ProsjektId\"},SQL_ProjectFromMergers,{\"FirmaId\", \"ProsjektId\"},\"SQL_ProjectFromMergers\",JoinKind.Inner),",
          "    #\"Expanded SQL_ProjectFromMergers\" = Table.ExpandTableColumn(FilterSelskap, \"SQL_ProjectFromMergers\", {\"CompanyId\", \"FromCompany\"}, {\"CompanyId\", \"FromCompany\"}),",
          "    VelgKolonner = Table.RemoveColumns(#\"Expanded SQL_ProjectFromMergers\",{\"HovedbokId\", \"DimensjonA\", \"DimensjonB\", \"DimensjonC\", \"DimensjonD\", \"MomsKode\", \"MotkontoType\", \"MotKonto\", \"TekstKode\", \"Tekst\", \"Periode\", \"Aar\", \"BunkeNummer\", \"RegistreringId\", \"Mengde\", \"KontoLnk\", \"DimAlnk\", \"ProsjektLnk\"}),",
          "    LevNummer = Table.TransformColumns(VelgKolonner, {{\"LevLnk\", each Text.AfterDelimiter(_, \"-\"), type text}}),",
          "    KundeNr = Table.TransformColumns(LevNummer, {{\"KundeLnk\", each Text.AfterDelimiter(_, \"-\"), type text}}),",
          "    KolonneNavn = Table.RenameColumns(KundeNr,{{\"Dato\", \"PostDato\"}, {\"DateLnk\", \"Dato\"}, {\"NettoBelop\", \"Belop\"}, {\"BilagsNummer\", \"BilagsId\"}, {\"LevLnk\", \"Lev\"}, {\"KundeLnk\", \"Kunde\"}}),",
          "    Datatyper = Table.TransformColumnTypes(KolonneNavn,{{\"BilagsId\", type text}, {\"KontoId\", type text}}),",
          "    NyKundeLnk = Table.AddColumn(Datatyper, \"KundeLnk\", each if Text.Length([Kunde])>0 then Text.From([FromCompany])&\"-\"&Text.From([Kunde]) else null, type text),",
          "    NyLevLnk = Table.AddColumn(NyKundeLnk, \"LevLnk\", each if Text.Length([Lev])>0 then Text.From([FromCompany])&\"-\"&Text.From([Lev]) else null, type text),",
          "    NyProsjektLnk = Table.AddColumn(NyLevLnk, \"ProsjektLnk\", each if [ProsjektId]<> null then Text.From([CompanyId])&\"-\"&Text.From([ProsjektId]) else null, type text),",
          "    NyKontoLnk = Table.AddColumn(NyProsjektLnk, \"KontoLnk\", each if [KontoId]<> null then Text.From([FromCompany])&\"-\"&Text.From([KontoId]) else null, type text),",
          "    fraEngelsk2Norsk = Table.RenameColumns(NyKontoLnk,{{\"CompanyId\", \"SelskapsId\"}}),",
          "    FjernGmlLnkFelt = Table.RemoveColumns(fraEngelsk2Norsk,{\"ProsjektId\", \"Lev\", \"Kunde\", \"KontoId\"}),",
          "    FiltrerResultat = Table.SelectRows(fraEngelsk2Norsk, each not Text.StartsWith([KontoId], \"1\") and not Text.StartsWith([KontoId], \"2\")),",
          "    MinDato = Table.AddColumn(FiltrerResultat, \"MinDato\", each #date(SisteAar - AntallAar,1,1),type date),",
          "    ProsjektPoster = Table.AddColumn(MinDato, \"NewDate\", each if Number.From([Dato]) < Number.From([MinDato]) then [MinDato] else [Dato], type date),",
          "    #\"Removed Columns\" = Table.RemoveColumns(ProsjektPoster,{\"Dato\", \"MinDato\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"NewDate\", \"Dato\"}}),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"Dato\", type date}, {\"PostDato\", type date}})",
          "in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "052dcc3b-3ea3-4300-bbab-2ad793cb38eb",
        "queryGroup": "Hjelpetabeller"
      },
      {
        "name": "SQL_ProjectFromMergers",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigasjon"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "   ",
          "table1 = \"IN_ProjecthistFromMergers\",",
          "table2 = \"Prosjekter\",",
          "table3 = \"Companies\",",
          "    sqlDatabase = Sql.Database(\"a2insight.database.windows.net\", \"a2dmHallmaker\"),",
          "",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
          "    sqlTbl2 = sqlDatabase{[Schema=\"dbo\",Item=(table2)]}[Data],",
          "    sqlTbl3 = sqlDatabase{[Schema=\"dbo\",Item=(table3)]}[Data],",
          "    FilterCompany = Table.SelectRows(sqlTbl3, each [CompanyId] = CompanyId),",
          "    ProjectId = Table.SelectColumns(sqlTbl2,{\"FirmaId\", \"ProsjektId\"}),",
          "    AddParentId = Table.AddColumn(ProjectId, \"ParentId\", each Text.BeforeDelimiter([ProsjektId], \"-\"), type text),",
          "    FilterParentProjects = Table.SelectRows(sqlTbl1, each [ProjectRef] = null),",
          "    #\"Merged Queries\" = Table.NestedJoin(FilterParentProjects,{\"FromCompany\"},sqlTbl3,{\"CompanyId\"},\"FilterParentProjects\",JoinKind.Inner),",
          "    #\"Expanded FilterParentProjects\" = Table.ExpandTableColumn(#\"Merged Queries\", \"FilterParentProjects\", {\"InfoEasyId\"}, {\"InfoEasyId\"}),",
          "    #\"Merged Queries1\" = Table.NestedJoin(AddParentId,{\"FirmaId\", \"ParentId\"},#\"Expanded FilterParentProjects\",{\"InfoEasyId\", \"FromProjectRef\"},\"Expanded FilterParentProjects\",JoinKind.Inner),",
          "    #\"Expanded Expanded FilterParentProjects\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Expanded FilterParentProjects\", {\"CompanyId\", \"FromCompany\"}, {\"CompanyId\", \"FromCompany\"}),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Expanded FilterParentProjects\",{\"ParentId\"}),",
          "    FilterProjects = Table.SelectRows(sqlTbl1, each [ProjectRef] <> null),",
          "    Custom1 = Table.NestedJoin(FilterProjects,{\"FromCompany\"},sqlTbl3,{\"CompanyId\"},\"FilterParentProjects\",JoinKind.Inner),",
          "    #\"Expanded FilterParentProjects1\" = Table.ExpandTableColumn(Custom1, \"FilterParentProjects\", {\"InfoEasyId\"}, {\"InfoEasyId\"}),",
          "    Custom2 = Table.NestedJoin(ProjectId,{\"FirmaId\", \"ProsjektId\"},#\"Expanded FilterParentProjects1\",{\"InfoEasyId\", \"FromProjectRef\"},\"Expanded FilterParentProjects1\",JoinKind.Inner),",
          "    #\"Expanded Expanded FilterParentProjects1\" = Table.ExpandTableColumn(Custom2, \"Expanded FilterParentProjects1\", {\"CompanyId\", \"FromCompany\", \"ProjectRef\"}, {\"CompanyId\", \"FromCompany\", \"ProjectRef\"}),",
          "    #\"Added Custom\" = Table.AddColumn(#\"Expanded Expanded FilterParentProjects1\", \"Custom\", each if [ProjectRef] = null then [ProsjektId] else [ProjectRef]),",
          "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Added Custom\",{\"ProsjektId\", \"ProjectRef\"}),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns1\",{{\"Custom\", \"ProsjektId\"}}),",
          "    #\"Appended Query\" = Table.Combine({#\"Renamed Columns\", #\"Removed Columns\"}),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Appended Query\",{{\"FirmaId\", Int64.Type}, {\"ProsjektId\", type text}})",
          "in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "df4fe5aa-5b91-42d1-8556-ab0185caf5c2",
        "queryGroup": "DataSources"
      },
      {
        "name": "AccountFromMergers",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "expression": [
          "let",
          "",
          "    table1 = \"Companies\",",
          "    table2 =\"KontoplanGrupper\",",
          "",
          "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
          "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
          "    sqlTbl2 = sqlDatabase{[Schema=\"dbo\",Item=(table2)]}[Data],",
          "",
          "    Source = RegnskapHistFromMergers,",
          "    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"KontoLnk\"}),",
          "    NewAccounts = Table.Distinct(#\"Removed Other Columns\"),",
          "    FromComp = Table.Distinct(Source, {\"FromCompany\"}),",
          "    #\"Merged Queries\" = Table.NestedJoin(sqlTbl1,{\"CompanyId\"},FromComp,{\"FromCompany\"},\"Custom1\",JoinKind.Inner),",
          "    #\"Removed Columns\" = Table.RemoveColumns(#\"Merged Queries\",{\"Custom1\"}),",
          "    #\"Merged Queries1\" = Table.NestedJoin(sqlTbl2,{\"SelskapsId\"},#\"Removed Columns\",{\"Company\"},\"Removed Columns\",JoinKind.Inner),",
          "    #\"Expanded Removed Columns\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Removed Columns\", {\"CompanyId\"}, {\"CompanyId\"}),",
          "    #\"Added Custom\" = Table.AddColumn(#\"Expanded Removed Columns\", \"KtoLnk\", each Text.From([CompanyId])&\"-\"&Text.From([Konto])),",
          "    #\"Merged Queries2\" = Table.NestedJoin(#\"Added Custom\",{\"KtoLnk\"},NewAccounts,{\"KontoLnk\"},\"Added Custom\",JoinKind.Inner),",
          "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Merged Queries2\",{\"SelskapsId\", \"TransferDate\", \"Added Custom\", \"CompanyId\"}),",
          "    #\"Added Custom1\" = Table.AddColumn(#\"Removed Columns1\", \"KontoFilter\", each Text.Start([Konto],1)),",
          "    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"KontoBeskrivelse\", each Text.From([Konto])&\"HM - \"&Text.From([Kontonavn])),",
          "    #\"Renamed Columns\" = Table.RenameColumns(#\"Added Custom2\",{{\"KtoLnk\", \"KontoLnk\"}}),",
          "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"KontoLnk\", type text}, {\"KontoFilter\", Int64.Type}, {\"KontoBeskrivelse\", type text}})",
          "in",
          "    #\"Changed Type\""
        ],
        "kind": "m",
        "lineageTag": "eca1edb8-53c2-44f5-80c5-64678874a3fc",
        "queryGroup": "Hjelpetabeller"
      }
    ],
    "queryGroups": [
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "0"
          }
        ],
        "folder": "Parametere"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "3"
          }
        ],
        "folder": "Dimensjoner"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "4"
          }
        ],
        "folder": "Fakta"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "5"
          }
        ],
        "folder": "Hjelpetabeller"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "6"
          }
        ],
        "folder": "Transform File from ProPrognose"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "0"
          }
        ],
        "folder": "Transform File from ProPrognose\\Sample Query"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "7"
          }
        ],
        "folder": "Transform File from ProNummerEndring"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "0"
          }
        ],
        "folder": "Transform File from ProNummerEndring\\Sample Query"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "2"
          }
        ],
        "folder": "DataSources"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "8"
          }
        ],
        "folder": "WorkInProgress"
      },
      {
        "annotations": [
          {
            "name": "PBI_QueryGroupOrder",
            "value": "1"
          }
        ],
        "folder": "DirectQ"
      }
    ],
    "relationships": [
      {
        "name": "33bc96d4-9087-48a5-ba4a-aba8389916e7",
        "fromColumn": "KontoLnk",
        "fromTable": "Regnskap",
        "toColumn": "KontoLnk",
        "toTable": "Kontoplan"
      },
      {
        "name": "1a1e1325-94ec-420a-90d8-cbf6d97bfbdc",
        "fromColumn": "KundeLnk",
        "fromTable": "Regnskap",
        "toColumn": "KundeLnk",
        "toTable": "Kunder"
      },
      {
        "name": "cf88f3bb-7cf6-4117-ac33-24a80db934c5",
        "fromColumn": "SelskapsId",
        "fromTable": "Regnskap",
        "toColumn": "SelskapsId",
        "toTable": "Selskap"
      },
      {
        "name": "135ff491-336a-4630-bdfb-1e80c7535b49",
        "fromColumn": "KontoLnk",
        "fromTable": "Regnskap",
        "toColumn": "KontoLnk1",
        "toTable": "NyeKontoer"
      },
      {
        "name": "0a7d0ff8-0d9d-4674-bfee-a9587ace4ec0",
        "fromColumn": "ProsjektLnk",
        "fromTable": "Regnskap",
        "toColumn": "ProsjektLnk",
        "toTable": "Prosjekt"
      },
      {
        "name": "65ff4602-d9e9-4444-a77b-1660e7125c8f",
        "fromColumn": "ProsjektLnk",
        "fromTable": "ProPrognose",
        "toColumn": "ProsjektLnk",
        "toTable": "Prosjekt"
      },
      {
        "name": "018c755c-e073-4957-8cba-6bee08196b69",
        "fromColumn": "HovedArbeidProsjektNr",
        "fromTable": "HpPrognose",
        "toColumn": "ProsjektNummer",
        "toTable": "Prosjekt"
      },
      {
        "name": "ecc2ca41-80f2-44f4-b813-62c8442280a2",
        "fromColumn": "CompanyId",
        "fromTable": "ProPrognose",
        "toColumn": "SelskapsId",
        "toTable": "Selskap"
      },
      {
        "name": "b7839e8d-11fb-4ebc-8629-bee0c847cef2",
        "fromColumn": "KundeLnk",
        "fromTable": "Betalinger",
        "toColumn": "KundeLnk",
        "toTable": "Kunder"
      },
      {
        "name": "9fb40977-56e2-4c29-8715-e7d9e143cdce",
        "fromColumn": "ProsjektLnk",
        "fromTable": "Betalinger",
        "toColumn": "ProsjektLnk",
        "toTable": "Prosjekt"
      },
      {
        "name": "31ee8c6f-3625-450e-9fd1-55db40c2905b",
        "crossFilteringBehavior": "bothDirections",
        "fromCardinality": "one",
        "fromColumn": "ProjectId",
        "fromTable": "Prosjekt",
        "toColumn": "ProjectId",
        "toTable": "LiveProjectForecast"
      },
      {
        "name": "d65b1d86-9342-4354-975f-f6d1102aef27",
        "fromColumn": "Dato",
        "fromTable": "Regnskap",
        "toColumn": "Dato",
        "toTable": "Kalender"
      },
      {
        "name": "32afaf79-c974-46c7-92af-5261c9e6ec6e",
        "fromColumn": "FakturaDato",
        "fromTable": "Regnskap",
        "isActive": false,
        "toColumn": "Dato",
        "toTable": "Kalender"
      },
      {
        "name": "905f28b8-8fbb-41de-9261-8fdb33230193",
        "fromColumn": "Date",
        "fromTable": "ProPrognose",
        "toColumn": "Dato",
        "toTable": "Kalender"
      },
      {
        "name": "1107c5ea-d1ae-47c8-b340-a36db1ac5fc4",
        "fromColumn": "Dato",
        "fromTable": "HpPrognose",
        "toColumn": "Dato",
        "toTable": "Kalender"
      },
      {
        "name": "5f2385fc-bb22-44aa-a2c9-fd60091430e0",
        "fromColumn": "Dato",
        "fromTable": "Betalinger",
        "toColumn": "Dato",
        "toTable": "Kalender"
      },
      {
        "name": "e31546ff-48d8-48b4-b1a5-2f88da79fbda",
        "fromColumn": "LevLnk",
        "fromTable": "Regnskap",
        "toColumn": "LevLnk",
        "toTable": "Leverandører"
      }
    ],
    "roles": [
      {
        "name": "Alt",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "7077c72f481d4c5c8f14c142c2d181b2"
          }
        ],
        "modelPermission": "read"
      },
      {
        "name": "5098",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "69536017967040f49f65ccba4e6cff83"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5098\""
          }
        ]
      },
      {
        "name": "5100",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "696a390130084589ac182325ea4d4f91"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5100\""
          }
        ]
      },
      {
        "name": "5101",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "1a8a28217a334101be2a690e6b4f3f3f"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5101\""
          }
        ]
      },
      {
        "name": "5102",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "1029b61a537145ed9e808020551eb544"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5102\""
          }
        ]
      },
      {
        "name": "5103",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "1b804e283b524513b39b3c30aea1804c"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5103\""
          }
        ]
      },
      {
        "name": "5105",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "70cc9f9b751346a2b398aa4f346be022"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5105\""
          }
        ]
      },
      {
        "name": "5106",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c24d924099c8470da8907c9025b25248"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5106\""
          }
        ]
      },
      {
        "name": "5107",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "274635dfe6fd40d496e3422de96bc23a"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5107\""
          }
        ]
      },
      {
        "name": "5109",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "776e6398c66047d7a384372a2eaf0019"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5109\""
          }
        ]
      },
      {
        "name": "5110",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "b6e4df1f34884d4db58321ff143f790c"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5110\""
          }
        ]
      },
      {
        "name": "6007",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "48143796ff1d4cfe800798414065a793"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"6007\""
          }
        ]
      },
      {
        "name": "Linto",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "f607803994f44f3593b40bdae68d1d1a"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[Avdeling] <> \"1\""
          }
        ]
      },
      {
        "name": "7200",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "a65199d3438446efb5444b0be584caf0"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7200\""
          }
        ]
      },
      {
        "name": "7201",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "214c3673819343d9a8ad0088882dfaca"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7201\""
          }
        ]
      },
      {
        "name": "7202",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "ead632bff2324d4a942f8669ffff6d4f"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7202\""
          }
        ]
      },
      {
        "name": "7203",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "5d8786844f25471e8cc05b5198930465"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7203\""
          }
        ]
      },
      {
        "name": "7204",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "0636bb7fa95a4af7a0f63b1f302ea6c8"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7204\""
          }
        ]
      },
      {
        "name": "7205",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "aff2f920576e4f2682e02142bdd3fc13"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7205\""
          }
        ]
      },
      {
        "name": "7206",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "ac14cad1a0b74274b7fab794123b8516"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7206\""
          }
        ]
      },
      {
        "name": "7207",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "460a3c76c3cb48b69cb920873a0794fc"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7207\""
          }
        ]
      },
      {
        "name": "7208",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "146d88f966004368bc8a4bd8695f35bb"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7208\""
          }
        ]
      },
      {
        "name": "7209",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "e35d0c368f0e4aaca9477495c731a3ed"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7209\""
          }
        ]
      },
      {
        "name": "7210",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "88d0b5f7cfe8453cbed7d5e70a4fb0d0"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7210\""
          }
        ]
      },
      {
        "name": "7215",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "53c9b76d371142c483788218359c1ac7"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7215\""
          }
        ]
      },
      {
        "name": "7211",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c931b79e5c6842e08d52b3debdeea01e"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7211\""
          }
        ]
      },
      {
        "name": "7212",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "fa2087afe95a43a68c213449d34907be"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7212\""
          }
        ]
      },
      {
        "name": "7213",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "d70c4449d9c74c4586961f429cd8f899"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7213\""
          }
        ]
      },
      {
        "name": "7214",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "ed727da54ad64d10b82330407b0a512f"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7214\""
          }
        ]
      },
      {
        "name": "7216",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "7941ab956e78436b9ef670209856a893"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7216\""
          }
        ]
      },
      {
        "name": "7217",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "421819defd3642678c8c1ddfa23f8bd4"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7217\""
          }
        ]
      },
      {
        "name": "7218",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "1bafbdd4f3f74341ba57193e8f7ef4de"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7218\""
          }
        ]
      },
      {
        "name": "7219",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "7ddd38ace10343c5a5261cb4f31c2301"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7219\""
          }
        ]
      },
      {
        "name": "7178",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "9aaee8a9a22a4fa1a71d3a13558c97b6"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"7178\""
          }
        ]
      },
      {
        "name": "5108",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "9a472347900d483989b7093bb5da5b84"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5108\""
          }
        ]
      },
      {
        "name": "5111",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "3ed5f0ba86014626aaa04bd8da63ddf8"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5111\""
          }
        ]
      },
      {
        "name": "5112",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "330e9369e77641068b381bd10063b05d"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5112\""
          }
        ]
      },
      {
        "name": "5113",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "8538fc485b774236ab231e38f49d3e5c"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5113\""
          }
        ]
      },
      {
        "name": "5114",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "af3c6b8e4c4b45c89b1ff8f1290899c4"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5114\""
          }
        ]
      },
      {
        "name": "5115",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "698ccfebacdc46879e1adbb22a417fe4"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5115\""
          }
        ]
      },
      {
        "name": "5116",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "f6aeef0599724cd5a6e70df98a9e3436"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5116\""
          }
        ]
      },
      {
        "name": "5117",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "5d324368a3b541e68b962df64f94ef44"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5117\""
          }
        ]
      },
      {
        "name": "5118",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "8d17111740e744f0b04e4680d563d982"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5118\""
          }
        ]
      },
      {
        "name": "5119",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "0ade092c576941fda44432f98665cc90"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5119\""
          }
        ]
      },
      {
        "name": "5123",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "2646d8af790a4ea492f99e4f873f5e65"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5123\""
          }
        ]
      },
      {
        "name": "5120",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "2626253148374cf994ba8fcaa0f0df93"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5120\""
          }
        ]
      },
      {
        "name": "5121",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "b3f7be2d498541b98778827b36983411"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5121\""
          }
        ]
      },
      {
        "name": "5122",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "a39af2bb42fc4d999082d8df423fb66f"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5122\""
          }
        ]
      },
      {
        "name": "5124",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "0f0f723ed95e46b1b0020f7f59dcb940"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5124\""
          }
        ]
      },
      {
        "name": "5125",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "ddbca7f17925454e9f328b1031cc4333"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5125\""
          }
        ]
      },
      {
        "name": "5126",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "960da20a9fd34f79b7172f08f732e42b"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5126\""
          }
        ]
      },
      {
        "name": "5127",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "fc89c2f9a20b46e088b4eb7f114a4d6b"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5127\""
          }
        ]
      },
      {
        "name": "5128",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "8714a5e4f34e4d32a9183d7c766f2eed"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5128\""
          }
        ]
      },
      {
        "name": "5129",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "637a77720a9546d188da0b16d1cb5341"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5129\""
          }
        ]
      },
      {
        "name": "5130",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c5209e0ac2334791b5e20ba802729a15"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5130\""
          }
        ]
      },
      {
        "name": "5131",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "05e1d46159a84f7280a918b3d705cba8"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5131\""
          }
        ]
      },
      {
        "name": "5132",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "9dedfa459ab548f9b2512d7d9c557a87"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5132\""
          }
        ]
      },
      {
        "name": "5133",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "fc9a0d2c27f548628d7e5aabdb1c3692"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5133\""
          }
        ]
      },
      {
        "name": "5134",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "28c513d3f15147cfbf91ecea65ebaf02"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5134\""
          }
        ]
      },
      {
        "name": "5135",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "03540a04e1ab4ddd997f0a4733a2202d"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5135\""
          }
        ]
      },
      {
        "name": "5136",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "2c6257cb3e934cb2a3ab2a783a66060e"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5136\""
          }
        ]
      },
      {
        "name": "5137",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "12ecd8ebe13147eeab991ccb29970bf3"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5137\""
          }
        ]
      },
      {
        "name": "5138",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "833c167efbc24437a344de85ff643694"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5138\""
          }
        ]
      },
      {
        "name": "5139",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "6bb0daabcada42cb9b0116b9e5257b20"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5139\""
          }
        ]
      },
      {
        "name": "5140",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "fb602a5ec0f544c39aa0cc8c3b419736"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5140\""
          }
        ]
      },
      {
        "name": "5141",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "6fb4050725114d059ed0f8aa9d4d09b9"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5141\""
          }
        ]
      },
      {
        "name": "5142",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "53fb09a30b3346c5ad889a5d409cc2dc"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5142\""
          }
        ]
      },
      {
        "name": "5143",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "472de738bb8e49fbbbd5acb69dfec615"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5143\""
          }
        ]
      },
      {
        "name": "5144",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "db5c7b89959f499ebe7ae7105ec2f2c9"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5144\""
          }
        ]
      },
      {
        "name": "5145",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "0612b7003b664722a80e501af50cb3ef"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5145\""
          }
        ]
      },
      {
        "name": "5146",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "9ce57d676bc34fe3999f369f56c853f7"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5146\""
          }
        ]
      },
      {
        "name": "5147",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "c7c3ecb809754fd4a26904789608ba12"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5147\""
          }
        ]
      },
      {
        "name": "5148",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "fb63c2df1b5b4b3cacf195ade2764653"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5148\""
          }
        ]
      },
      {
        "name": "5149",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "bf5001cf15484162a4bca64a18edb6b4"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5149\""
          }
        ]
      },
      {
        "name": "5150",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "643c60c250d944488ef46f1f1593b66f"
          }
        ],
        "modelPermission": "read",
        "tablePermissions": [
          {
            "name": "Prosjekt",
            "filterExpression": "[HovedArbeidProsjektNr] = \"5150\""
          }
        ]
      }
    ],
    "sourceQueryCulture": "nb-NO",
    "tables": [
      {
        "name": "Betalinger",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "Belop",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ba8d142b-81c3-4c7d-91f1-ef7428c881fe",
            "sourceColumn": "Belop",
            "summarizeBy": "sum"
          },
          {
            "name": "BilagsNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5f602491-481c-4eeb-a75d-47d941a297d7",
            "sourceColumn": "BilagsNummer",
            "summarizeBy": "sum"
          },
          {
            "name": "BokfDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "203787ae-c46a-489d-a032-8a0db51a4d7c",
            "sourceColumn": "BokfDato",
            "summarizeBy": "none"
          },
          {
            "name": "CompanyId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4daf3340-bf11-4238-bf8e-bcefad6fc54f",
            "sourceColumn": "CompanyId",
            "summarizeBy": "count"
          },
          {
            "name": "Dato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "aa7310ef-7cc5-4600-a5a9-c183b6ef3b58",
            "sourceColumn": "Dato",
            "summarizeBy": "none"
          },
          {
            "name": "FirmaId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2e7cf8e4-223f-4e05-9221-57b0dae31ff9",
            "sourceColumn": "FirmaId",
            "summarizeBy": "count"
          },
          {
            "name": "ForfallsDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "0a9b8829-a33f-4e67-8300-199fb62c0e43",
            "sourceColumn": "ForfallsDato",
            "summarizeBy": "none"
          },
          {
            "name": "KundeId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "97e1a98d-10db-4544-948a-af969d4ca587",
            "sourceColumn": "KundeId",
            "summarizeBy": "none"
          },
          {
            "name": "KundeLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2ed870f4-548c-4b7e-845e-17ff5bad4da4",
            "sourceColumn": "KundeLnk",
            "summarizeBy": "none"
          },
          {
            "name": "NOK",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "f0f9e380-1312-47cb-8ca4-82a0d9153e1b",
            "sourceColumn": "NOK",
            "summarizeBy": "sum"
          },
          {
            "name": "PostNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "29ba6355-fa2f-41db-afa6-a1d8cd8288d8",
            "sourceColumn": "PostNummer",
            "summarizeBy": "sum"
          },
          {
            "name": "ProsjektLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e50568ae-180c-4106-b90e-149f559bab1e",
            "sourceColumn": "ProsjektLnk",
            "summarizeBy": "none"
          },
          {
            "name": "Tekst",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4e085aa7-5c74-4a52-9ba9-88c3fce738a2",
            "sourceColumn": "Tekst",
            "summarizeBy": "none"
          },
          {
            "name": "TekstKode",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "db3c34ae-9d0c-4ab9-8425-c8a928894b3a",
            "sourceColumn": "TekstKode",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "001674b6-b784-40e9-ad43-28f2a8aa67e2",
        "measures": [
          {
            "name": "UtgFakturaNOK",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CALCULATE(-SUM(Betalinger[Belop]),FILTER(Betalinger,AND(Betalinger[TekstKode]<>6,Betalinger[TekstKode]<>9)))",
            "lineageTag": "96600e71-4ddc-45cc-8f95-ec4139c2713e"
          }
        ],
        "partitions": [
          {
            "name": "Betalinger-d5153bac-a5e2-4ccc-9e06-9e3d87bc95a1",
            "mode": "import",
            "queryGroup": "Fakta",
            "source": {
              "expression": [
                "let",
                "   ",
                "//Procedure",
                "    #\"Merged Queries\" = Table.NestedJoin(SQL_CustomersAccounts,{\"FirmaId\"},SQL_Company,{\"InfoEasyId\"},\"Temp\",JoinKind.Inner),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Merged Queries\",{\"Temp\"}),",
                "    #\"Inserted Year\" = Table.AddColumn(#\"Removed Columns1\", \"Old\", each if Date.Year([Dato]) < (SisteAar - AntallAar) then #date(SisteAar - AntallAar,1,1) else [Dato]),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Inserted Year\",{\"Dato\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"Old\", type date}, {\"ForfallsDato\", type date}, {\"BokfDato\", type date}}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Changed Type\",{{\"Old\", \"Dato\"}})",
                "in",
                "    #\"Renamed Columns1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Faktorer",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Enhet",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "381d9a16-1193-4c98-8214-da66ffe0dd7f",
            "sortByColumn": "Faktor",
            "sourceColumn": "Enhet",
            "summarizeBy": "none"
          },
          {
            "name": "Faktor",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "int64",
            "lineageTag": "4f702a1a-c5ec-4211-84f3-b50ad7aa0942",
            "sourceColumn": "Faktor",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "770fcd3b-8006-42fa-a82c-188060a65907",
        "measures": [
          {
            "name": "Rapportfaktor",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CALCULATE(Min(Faktorer[Faktor]),FILTER(Faktorer, Faktorer[Faktor]=[Unit]))",
            "lineageTag": "58b8ac35-e572-4237-aa31-9babcaa29f74"
          },
          {
            "name": "Unit",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "MAX(Faktorer[Faktor])",
            "lineageTag": "bfb04ea9-1de9-44d6-9ea5-0d25b1fa2f44"
          }
        ],
        "partitions": [
          {
            "name": "Faktorer",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "   ",
                "table1 = \"Factors\",",
                "",
                "    sqlDatabase = Sql.Database(\"a2insight.database.windows.net\", \"a2dmHallmaker\"),",
                "",
                "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
                "",
                "    columns2Norwegian = Table.RenameColumns(sqlTbl1,{{\"Unit\", \"Enhet\"}, {\"Factor\", \"Faktor\"}})",
                "in",
                "    columns2Norwegian"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "HpPrognose",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Dato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "bd9cb18f-2d2d-498d-8933-bdb3524e15b8",
            "sourceColumn": "Dato",
            "summarizeBy": "none"
          },
          {
            "name": "FirstDate",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "expression": "MINX(FILTER(HpPrognose,HpPrognose[HovedArbeidProsjektNr]=EARLIER(HpPrognose[HovedArbeidProsjektNr])),HpPrognose[Dato])",
            "formatString": "General Date",
            "isDataTypeInferred": true,
            "lineageTag": "657cf5de-56a3-4378-8709-71e6a54d7627",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "HovedArbeidProsjektNr",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7cb43931-3de7-45e5-a280-57aaea8a473e",
            "sourceColumn": "HovedArbeidProsjektNr",
            "summarizeBy": "none"
          },
          {
            "name": "Inntekter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "dataType": "double",
            "formatString": "#,0",
            "lineageTag": "1d5cf549-8efd-471c-831e-c8422e19ad05",
            "sourceColumn": "Inntekter",
            "summarizeBy": "sum"
          },
          {
            "name": "Kostnader",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "dataType": "double",
            "formatString": "#,0",
            "lineageTag": "2caaf950-df1a-4451-8367-cd3c42d2668d",
            "sourceColumn": "Kostnader",
            "summarizeBy": "sum"
          },
          {
            "name": "Slutt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "f89fc05b-ac7e-4c58-8fb8-ee365ddcfc42",
            "sourceColumn": "Slutt",
            "summarizeBy": "none"
          },
          {
            "name": "Start",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "4c9507a7-59a4-48df-b2bb-8f49b758ccf1",
            "sourceColumn": "Start",
            "summarizeBy": "none"
          },
          {
            "name": "Varighet",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8fac454c-19b1-4e7d-b9bb-634f60c0dec9",
            "sourceColumn": "Varighet",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "5e06afec-8350-42ed-8b46-bc10498d1a55",
        "measures": [
          {
            "name": "DGprogGraf",
            "expression": "DIVIDE([InntProgGraf]-[KostProgGraf],[InntProgGraf])",
            "formatString": "0.00\\ %;-0.00\\ %;0.00\\ %",
            "lineageTag": "33d432b0-8f75-44e3-960e-ec8fa5536135"
          },
          {
            "name": "InntProgGraf",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "DIVIDE(SUM(HpPrognose[Inntekter]),Faktorer[Rapportfaktor])",
            "lineageTag": "46c40afc-1189-4974-863e-17ba43edb6ca"
          },
          {
            "name": "KostProgGraf",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "DIVIDE(SUM(HpPrognose[Kostnader]),Faktorer[Rapportfaktor])",
            "formatString": "#,0",
            "lineageTag": "4d83436a-f111-47ba-bd00-dfe56386d730"
          },
          {
            "name": "AntattFerdigDte",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "expression": "MAX(HpPrognose[Slutt])",
            "lineageTag": "3f3bad59-111f-4080-84d4-a23048640d19"
          },
          {
            "name": "Measure",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CALCULATE(SUM(HpPrognose[Inntekter]),FIRSTDATE(Kalender[Dato])) ",
            "lineageTag": "77473beb-31f4-47a8-8380-ea94e81701b4"
          }
        ],
        "partitions": [
          {
            "name": "HpPrognose-ed06083f-2d77-477b-b135-a5cb0ba52aad",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "    Source = Table.NestedJoin(DatesFromProjects,{\"HovedArbeidProsjektNr\"},DatesFromForecast,{\"Hovedarbeidsprosjekt\"},\"DatesFromForecast\",JoinKind.RightOuter),",
                "    #\"Expanded DatesFromForecast\" = Table.ExpandTableColumn(Source, \"DatesFromForecast\", {\"Start\", \"Slutt\", \"Dato\"}, {\"Start.1\", \"Slutt.1\", \"Date\"}),",
                "    #\"Added Custom2\" = Table.AddColumn(#\"Expanded DatesFromForecast\", \"CStart\", each ",
                "\tif [Start] = null ",
                "\tthen ",
                "\t\tif [Start.1] = null ",
                "\t\tthen Date.StartOfMonth(DateTime.Date(DateTime.LocalNow()))",
                "\t\telse [Start.1]",
                "\telse [Start], type date),",
                "    #\"Added Custom3\" = Table.AddColumn(#\"Added Custom2\", \"CSlutt\", each if Number.From(",
                "\t\tif Number.From([Slutt.1]) = null ",
                "\t\tthen ",
                "\t\t\tif Number.From([Slutt]) = null ",
                "\t\t\tthen DateTime.Date(DateTime.LocalNow())",
                "\t\t\telse [Slutt]",
                "\t\telse [Slutt.1]",
                "\t\t)\t< Number.From(DateTime.Date(DateTime.LocalNow())) ",
                "\tthen Date.EndOfMonth(DateTime.Date(DateTime.LocalNow()))",
                "\telse ",
                "\t\tif Number.From([Slutt.1]) = null ",
                "\t\tthen ",
                "\t\t\tif Number.From([Slutt]) = null ",
                "\t\t\tthen Date.EndOfMonth(DateTime.Date(DateTime.LocalNow()))",
                "\t\t\telse [Slutt]",
                "\t\telse [Slutt.1], type date),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Added Custom3\",{\"Start\", \"Slutt\", \"Start.1\", \"Slutt.1\"}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns1\",{{\"CStart\", \"Start\"}, {\"CSlutt\", \"Slutt\"}}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Renamed Columns1\", \"ListOfDates\", each List.Transform({Number.From([Date])..Number.From([Slutt])},each Date.From(_))),",
                "    #\"Expanded ListOfDates\" = Table.ExpandListColumn(#\"Added Custom\", \"ListOfDates\"),",
                "    #\"Inserted Start of Month\" = Table.AddColumn(#\"Expanded ListOfDates\", \"Dato\", each Date.StartOfMonth([ListOfDates]), type date),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Inserted Start of Month\",{\"ListOfDates\", \"Date\"}),",
                "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Columns\", {\"HovedArbeidProsjektNr\", \"Start\", \"Slutt\", \"Dato\"}),",
                "    #\"Added Custom1\" = Table.AddColumn(#\"Removed Duplicates\", \"Varighet\", each Number.From([Slutt])-Number.From([Start])+1),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom1\",{{\"HovedArbeidProsjektNr\", type text}, {\"Varighet\", Int64.Type}}),",
                "    #\"Merged Queries\" = Table.NestedJoin(#\"Changed Type\",{\"HovedArbeidProsjektNr\", \"Dato\"},ProjectForecast,{\"Hovedarbeidsprosjekt\", \"Date\"},\"ForecastFromForecast\",JoinKind.LeftOuter),",
                "    #\"Expanded ForecastFromForecast\" = Table.ExpandTableColumn(#\"Merged Queries\", \"ForecastFromForecast\", {\"CostAcc\", \"RevenueAcc\"}, {\"CostAcc\", \"RevenueAcc\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded ForecastFromForecast\",{{\"CostAcc\", \"Kostnader\"}, {\"RevenueAcc\", \"Inntekter\"}}),",
                "    #\"Sorted Rows\" = Table.Sort(#\"Renamed Columns\",{{\"HovedArbeidProsjektNr\", Order.Ascending}, {\"Dato\", Order.Ascending}}),",
                "    #\"Filled Down\" = Table.FillDown(#\"Sorted Rows\",{\"Inntekter\", \"Kostnader\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Filled Down\", each ([HovedArbeidProsjektNr] <> null))",
                "in",
                "    #\"Filtered Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Kalender",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Dato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "baade224-815c-445b-a796-6381318cd439",
            "sourceColumn": "Dato",
            "summarizeBy": "none"
          },
          {
            "name": "KortMnd",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8827a0f3-2fca-490b-ae3a-92e6ec67b97e",
            "sortByColumn": "MndNo",
            "sourceColumn": "KortMnd",
            "summarizeBy": "none"
          },
          {
            "name": "KortÅr",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "RIGHT(Kalender[År],2)",
            "isDataTypeInferred": true,
            "lineageTag": "b4584c49-fd43-4a9d-9082-cbd29ecd17d3",
            "summarizeBy": "none",
            "type": "calculated"
          },
          {
            "name": "Kvartal",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c01feca4-0487-4a24-9ebb-aeaa06dcab5a",
            "sourceColumn": "Kvartal",
            "summarizeBy": "none"
          },
          {
            "name": "Mnd",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ef144f76-746e-41f9-ad4f-fec20d4eb7c0",
            "sortByColumn": "MndNo",
            "sourceColumn": "Mnd",
            "summarizeBy": "none"
          },
          {
            "name": "MndNo",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "67e215b8-4a77-4344-ab8e-421ec72e9eb4",
            "sourceColumn": "MndNo",
            "summarizeBy": "sum"
          },
          {
            "name": "Termin",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "expression": "ROUND(Kalender[MndNo] / 2, 0) ",
            "isDataTypeInferred": true,
            "lineageTag": "4fdb8aa5-66ca-423c-bcb5-3cffac8b5eea",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Tertial",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6f1b4da4-f09a-41fa-94ce-b38708a99671",
            "sourceColumn": "Tertial",
            "summarizeBy": "none"
          },
          {
            "name": "TxYY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c1b2f5d5-fa3c-4c4c-98b0-9bddc94c8f5b",
            "sourceColumn": "TxYY",
            "summarizeBy": "none"
          },
          {
            "name": "YYYYMM",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3049810a-f141-4a1a-8cb0-542608d65292",
            "sourceColumn": "YYYYMM",
            "summarizeBy": "sum"
          },
          {
            "name": "År",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b9fbcd8c-fd81-40b6-9c6c-7e8260089a0b",
            "sourceColumn": "År",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "e4d4406f-7939-4b5e-a6e7-689dedbe817b",
        "measures": [
          {
            "name": "EndOf",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "MAX(Kalender[Dato])",
            "lineageTag": "a07bca7e-1196-48c0-b7c3-f1080edffcd5"
          },
          {
            "name": "Periode filter",
            "expression": "CONCATENATE(\"Periode : \",COMBINEVALUES(\"-\",SELECTEDVALUE(Kalender[KortMnd]),SELECTEDVALUE(Kalender[År])))",
            "lineageTag": "53767b95-9e74-4e97-aa7c-bd40e2538aec"
          }
        ],
        "partitions": [
          {
            "name": "Kalender",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "    Source = (SisteAar),",
                "    #\"Converted to Table\" = #table(1, {{Source}}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Converted to Table\", \"Dato\", each List.Dates(#date(SisteAar-AntallAar + 1, 1, 1),366*AntallAar,#duration(1,0,0,0))),",
                "    #\"Expanded Dato\" = Table.ExpandListColumn(#\"Added Custom\", \"Dato\"),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Dato\",{\"Column1\"}),",
                "    Dato = Table.TransformColumnTypes(#\"Removed Columns\",{{\"Dato\", type date}}),",
                "    År = Table.AddColumn(Dato, \"År\", each Date.Year([Dato]), Int64.Type),",
                "    #\"Filtered Rows\" = Table.SelectRows(År, each [År] <= SisteAar),",
                "    MndNo = Table.AddColumn(#\"Filtered Rows\", \"MndNo\", each Date.Month([Dato]), Int64.Type),",
                "    Mnd = Table.AddColumn(MndNo, \"Mnd\", each Date.MonthName([Dato]), type text),",
                "    #\"Capitalized Each Word\" = Table.TransformColumns(Mnd,{{\"Mnd\", Text.Proper, type text}}),",
                "    KortMnd = Table.AddColumn(#\"Capitalized Each Word\", \"KortMnd\", each Text.Start([Mnd], 3), type text),",
                "    Kvartal = Table.AddColumn(KortMnd, \"Kvartal\", each \"Q\"&Text.From(Number.RoundUp( [MndNo] / 3 ) ), type text ),",
                "    Tertial = Table.AddColumn(Kvartal, \"Tertial\", each \"T\"&Text.From(Number.RoundUp( [MndNo] / 4 ) ), type text ),",
                "    TxYY = Table.AddColumn(Tertial, \"TxYY\", each [Tertial]&\"-\"&Text.End(Text.From([År]),2), type text),",
                "    YYYYMM = Table.AddColumn(TxYY, \"YYYYMM\", each [År]*100 + [MndNo], Int64.Type)",
                "in",
                "    YYYYMM"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Kontoplan",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "AccountId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "f4e0e60e-80fc-4e3e-9b8c-501f465f4dbd",
            "sourceColumn": "AccountId",
            "summarizeBy": "none"
          },
          {
            "name": "AccountL0",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "153a27ef-b10e-4544-8bf5-15abcff81310",
            "sourceColumn": "AccountL0",
            "summarizeBy": "none"
          },
          {
            "name": "AccountL1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d98778b3-b28f-4efa-ad0b-6905977e1f11",
            "sourceColumn": "AccountL1",
            "summarizeBy": "none"
          },
          {
            "name": "Eliminering",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e944bea4-11ee-4bd3-b669-6bb5435f4dd2",
            "sourceColumn": "Eliminering",
            "summarizeBy": "none"
          },
          {
            "name": "Fortegn",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "da637f4b-2352-4832-b96e-6aebf8f1e8b5",
            "sourceColumn": "Fortegn",
            "summarizeBy": "none"
          },
          {
            "name": "Konto",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "b4098cca-3f72-47ab-a09f-b7fd86f0d790",
            "sourceColumn": "Konto",
            "summarizeBy": "none"
          },
          {
            "name": "KontoBeskrivelse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "983fd124-68a2-4ece-a546-a3b83fadeee5",
            "sourceColumn": "KontoBeskrivelse",
            "summarizeBy": "none"
          },
          {
            "name": "KontoFilter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "786cb3d3-847f-4b66-b1cd-8b59074ca29c",
            "sourceColumn": "KontoFilter",
            "summarizeBy": "none"
          },
          {
            "name": "KontoLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "558a620c-b0d4-44c8-ae35-1065bfc938b9",
            "sourceColumn": "KontoLnk",
            "summarizeBy": "none"
          },
          {
            "name": "Kontonavn",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0385fcc2-1633-4fbc-a38a-6d120bd508ea",
            "sourceColumn": "Kontonavn",
            "summarizeBy": "none"
          },
          {
            "name": "N1Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "2c8590cb-39ed-44b6-a1dc-14a000212f13",
            "sourceColumn": "N1Sort",
            "summarizeBy": "none"
          },
          {
            "name": "N2Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "e98ef674-ec92-4fad-951e-3a556f9dc717",
            "sourceColumn": "N2Sort",
            "summarizeBy": "none"
          },
          {
            "name": "N3Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "107a64e8-8197-49c8-9fcd-b2124d20db51",
            "sourceColumn": "N3Sort",
            "summarizeBy": "none"
          },
          {
            "name": "Nivå1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f1b2b004-a35d-44c1-955f-8e21b6d7e397",
            "sourceColumn": "Nivå1",
            "summarizeBy": "none"
          },
          {
            "name": "Nivå2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "517347df-c1ee-4abc-9ce2-46e883d45a85",
            "sourceColumn": "Nivå2",
            "summarizeBy": "none"
          },
          {
            "name": "Nivå3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e816ae2e-3d44-47e6-9461-699cb5858b72",
            "sourceColumn": "Nivå3",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjektGruppe",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4ee14021-8a5c-427f-9667-cba6e1ef0419",
            "sourceColumn": "ProsjektGruppe",
            "summarizeBy": "none"
          },
          {
            "name": "RappSort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c81b8b5b-5428-4cac-aaf9-583b5f0faa98",
            "sourceColumn": "RappSort",
            "summarizeBy": "none"
          },
          {
            "name": "Rapport",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b38c0b78-ca7f-4e2a-a902-b9515a840853",
            "sourceColumn": "Rapport",
            "summarizeBy": "none"
          },
          {
            "name": "Side",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "81e2df99-8037-4481-974f-ef032e1b226a",
            "sourceColumn": "Side",
            "summarizeBy": "none"
          },
          {
            "name": "SideSort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "1633ec64-5c25-4d69-b91c-b10b28fab543",
            "sourceColumn": "SideSort",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "ab6463c0-2e78-478b-b894-33a5686ff02b",
        "partitions": [
          {
            "name": "Kontoplan",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "",
                "//Procedure",
                "",
                "    joinSharepointAndSql = Table.NestedJoin(SQL_ReportingCOA,{\"SelskapsId\"},SQL_Company,{\"OldSelskapsId\"},\"Companies\",JoinKind.Inner),",
                "    CompanyId = Table.ExpandTableColumn(joinSharepointAndSql, \"Companies\", {\"CompanyId\"}, {\"CompanyId\"}),",
                "    KontoLnk = Table.AddColumn(CompanyId, \"KontoLnk\", each Text.From([CompanyId])&\"-\"&Text.From([Konto]), type text),",
                "    RemoveColumns = Table.RemoveColumns(KontoLnk,{\"SelskapsId\", \"CompanyId\", \"TransferDate\"}),",
                "    AddAccountFilter = Table.AddColumn(RemoveColumns, \"KontoFilter\", each Number.From(Text.Start([Konto],1)), Int64.Type),",
                "    AddAccountDesc = Table.AddColumn(AddAccountFilter, \"KontoBeskrivelse\", each Text.From([Konto])&\" - \"&[Kontonavn], type text),",
                "    #\"Sorted Rows\" = Table.Sort(AddAccountDesc,{{\"Konto\", Order.Ascending}})",
                "in",
                "    #\"Sorted Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Kunder",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "IC Kunder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "lineageTag": "265e63b8-29ea-46cc-a17c-10c6435f5669",
            "sourceColumn": "IC Kunder",
            "summarizeBy": "none"
          },
          {
            "name": "Kunde",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "88486d94-3f49-4d39-84ff-b464ef0acb46",
            "sourceColumn": "Kunde",
            "summarizeBy": "none"
          },
          {
            "name": "KundeId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b0540a34-6342-40c7-b9a9-dd66a20dc19e",
            "sourceColumn": "KundeId",
            "summarizeBy": "none"
          },
          {
            "name": "KundeLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7e3988a7-536c-4d40-92ab-db8bb0aaefbf",
            "sourceColumn": "KundeLnk",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "8935626e-f0eb-4460-91c9-cfa7e4d55ffc",
        "partitions": [
          {
            "name": "Kunder-64b9bc3e-fe2f-4c2a-95db-7fd38cb258bf",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "",
                "/*",
                "//SharePoint",
                "",
                "    SharePoint = SharePoint.Tables(SharePointSite1, [ApiVersion = 15]),",
                "    CompanyTbl = SharePoint{[Id=\"c6c05096-82a1-486e-af74-d9aca84f2740\"]}[Items],",
                "    SelectColumns = Table.RemoveColumns(CompanyTbl,{\"FileSystemObjectType\", \"Id\", \"ServerRedirectedEmbedUri\", \"ServerRedirectedEmbedUrl\", \"ContentTypeId\", \"ComplianceAssetId\", \"Modified\", \"Created\", \"AuthorId\", \"EditorId\", \"OData__UIVersionString\", \"Attachments\", \"GUID\", \"FirstUniqueAncestorSecurableObject\", \"RoleAssignments\", \"Activities\", \"AttachmentFiles\", \"ContentType\", \"GetDlpPolicyTip\", \"FieldValuesAsHtml\", \"FieldValuesAsText\", \"FieldValuesForEdit\", \"File\", \"Folder\", \"LikedByInformation\", \"ParentList\", \"Properties\", \"Versions\", \"Author\", \"Editor\", \"ID\"}),",
                "    RenameColumns = Table.RenameColumns(SelectColumns,{{\"Title\", \"Company\"}}),",
                "    Company = Table.SelectRows(RenameColumns, each [Company] = companyId),",
                "",
                "//SQL",
                "",
                "    table1 = \"Kunder\",",
                "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
                "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
                "*/",
                "",
                "//Procedure",
                "    #\"Merged Queries\" = Table.NestedJoin(SQL_Customers,{\"FirmaId\"},SQL_Company,{\"InfoEasyId\"},\"Temp\",JoinKind.Inner),",
                "    #\"Expanded Temp\" = Table.ExpandTableColumn(#\"Merged Queries\", \"Temp\", {\"CompanyId\"}, {\"CompanyId\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded Temp\", \"Custom\", each if Text.Length(Text.From([KundeId])) = 0 then null else Text.From([CompanyId])&\"-\"&Text.From([KundeId])),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Added Custom\",{\"FirmaId\", \"KundeLnk\", \"CompanyId\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns1\",{{\"Custom\", \"KundeLnk\"}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns\",null,\"\",Replacer.ReplaceValue,{\"Kunde\"}),",
                "    #\"Duplicated Column\" = Table.DuplicateColumn(#\"Replaced Value\", \"Kunde\", \"Kunde - Copy\"),",
                "    #\"Uppercased Text\" = Table.TransformColumns(#\"Duplicated Column\",{{\"Kunde - Copy\", Text.Upper, type text}}),",
                "    #\"Added Conditional Column\" = Table.AddColumn(#\"Uppercased Text\", \"IC Kunder\", each if Text.Contains([#\"Kunde - Copy\"], \"HALLMAKER\") then 1 else if Text.Contains([#\"Kunde - Copy\"], \"RUBB\") then 1 else if Text.Contains([#\"Kunde - Copy\"], \"PLAMEK\") then 1 else 0),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Conditional Column\",{\"Kunde - Copy\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"KundeId\", type text}, {\"Kunde\", type text}, {\"KundeLnk\", type text}, {\"IC Kunder\", type logical}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Leverandører",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "FirmaId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "346a8720-a58d-4d2d-ab10-b100806f79ae",
            "sourceColumn": "FirmaId",
            "summarizeBy": "none"
          },
          {
            "name": "Land",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "60f7de0e-9b3c-4fb6-b8bd-d44b56ae576b",
            "sourceColumn": "Land",
            "summarizeBy": "none"
          },
          {
            "name": "LevId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "0dab3487-d967-4aaf-bec3-ee263b4eea7b",
            "sourceColumn": "LevId",
            "summarizeBy": "none"
          },
          {
            "name": "LevLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "44a05fea-982c-419e-9098-3e49b0c10ab5",
            "sourceColumn": "LevLnk",
            "summarizeBy": "none"
          },
          {
            "name": "Leverandor",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8cb84ab2-8262-49ac-a57f-ba02136f46ab",
            "sourceColumn": "Leverandor",
            "summarizeBy": "none"
          },
          {
            "name": "LeverandorBeskrivelse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "58a29615-e8b2-4cd9-b607-6926f5753752",
            "sourceColumn": "LeverandorBeskrivelse",
            "summarizeBy": "none"
          },
          {
            "name": "PostStedNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "85172a06-73ef-43be-a630-085eac00e0a2",
            "sourceColumn": "PostStedNummer",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "68882e3b-f240-4049-819b-bad1ce2ffccf",
        "partitions": [
          {
            "name": "Leverandører-1f2ab0a9-b9e9-4ad6-82b2-2651f4e7720b",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "   ",
                "",
                "//Procedure",
                "",
                "    #\"Merged Queries\" = Table.NestedJoin(SQL_Suppliers,{\"FirmaId\"},SQL_Company,{\"InfoEasyId\"},\"Temp\",JoinKind.Inner),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Merged Queries\",{\"Temp\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "LiveProjectForecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Cost",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "96c7b9ed-4439-468d-9f7f-7e01810cdee6",
            "sourceColumn": "Cost",
            "sourceProviderType": "float",
            "summarizeBy": "sum"
          },
          {
            "name": "NickName",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4554e0c7-f2a4-45a2-9a3f-59657bdc12e4",
            "sourceColumn": "NickName",
            "sourceProviderType": "varchar(50)",
            "summarizeBy": "none"
          },
          {
            "name": "ProjectId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isNullable": false,
            "lineageTag": "21177a05-1166-4706-9744-fe634fc6e9f7",
            "sourceColumn": "ProjectId",
            "sourceProviderType": "bigint",
            "summarizeBy": "none"
          },
          {
            "name": "ProjectManagerId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "ee3ab189-bc2b-411f-9d9e-a6f47d8ae21e",
            "sourceColumn": "ProjectManagerId",
            "sourceProviderType": "bigint",
            "summarizeBy": "count"
          },
          {
            "name": "Revenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "644d4356-06a2-4eda-b8b4-61aca34de171",
            "sourceColumn": "Revenue",
            "sourceProviderType": "float",
            "summarizeBy": "sum"
          },
          {
            "name": "Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4a2e214c-4c56-47c8-bb32-e3a1f91229f7",
            "sourceColumn": "Status",
            "sourceProviderType": "varchar(1)",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "127f54a5-c3b0-4072-969c-248e600964b7",
        "measures": [
          {
            "name": "LiveStage",
            "expression": "CONCATENATE(IF(HASONEVALUE(Prosjekt[HP Beskrivelse]),MAX(LiveProjectForecast[Status]),BLANK()),BLANK())",
            "lineageTag": "d062c52d-ff15-48b7-b9f0-9fa2827f7328"
          },
          {
            "name": "RevenueForecastLive",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUM(LiveProjectForecast[Revenue])",
            "formatString": "#,0",
            "lineageTag": "e5988e81-f0b7-49a0-b3c8-fac5a7fac07c"
          },
          {
            "name": "CostForecastLive",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUM(LiveProjectForecast[Cost])",
            "formatString": "#,0",
            "lineageTag": "49fdc4fe-acb5-421a-a9bd-51d2da244a4a"
          },
          {
            "name": "Justert",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "ABS([Inntektsprognose]-[RevenueForecastLive])+ABS([Kostnadsprognose]-[CostForecastLive])",
            "lineageTag": "bb2c1ed6-89b2-4c57-8172-de537d0f603d"
          },
          {
            "name": "RevenueForecastAdj",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "IF([Justert]>0,[RevenueForecastLive],\" \")",
            "formatString": "#,0",
            "lineageTag": "c115c477-60ab-4af2-8cad-6bc9ac1f57ce"
          },
          {
            "name": "CostForecastAdj",
            "expression": "IF([Justert]>0,[CostForecastLive],\" \")",
            "lineageTag": "a56bb226-16c8-448f-9c4b-34742e59a2bd"
          },
          {
            "name": "GrossContributionForecastAdj",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "IF([Justert]>0,[RevenueForecastLive]-[CostForecastLive],\" \")",
            "formatString": "#,0",
            "lineageTag": "65b9baa0-15ba-4124-8ef2-5f1714f83447"
          },
          {
            "name": "GrossMarginForecastAdj",
            "expression": "IF([Justert]>0,DIVIDE([GrossContributionForecastAdj],[RevenueForecastAdj]),\" \")",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "079f0d63-edad-4a3d-9920-664d4ada7f40"
          },
          {
            "name": "CostAdj",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[CostForecastLive]-[Kostnadsprognose]",
            "formatString": "#,0",
            "lineageTag": "c3f2f479-a968-45db-a24c-a52dc9698749"
          }
        ],
        "partitions": [
          {
            "name": "LiveProjectForecast-6b5691de-b6d2-4b19-9467-4a99b687452c",
            "mode": "directQuery",
            "queryGroup": "DirectQ",
            "source": {
              "expression": [
                "let",
                "    Source = Sql.Database(\"a2insight.database.windows.net\", \"a2dmHallmaker\"),",
                "    dbo_LU_Projects = Source{[Schema=\"dbo\",Item=\"LU_Projects\"]}[Data],",
                "    dbo_LU_ProjectMgrs = Source{[Schema=\"dbo\",Item=\"LU_ProjectMgrs\"]}[Data],",
                "    dbo_FA_ProjectForecastChanges = Source{[Schema=\"dbo\",Item=\"FA_ProjectForecastChanges\"]}[Data],",
                "",
                "    #\"Merged Queries\" = Table.NestedJoin(dbo_LU_Projects,{\"ProjectManagerId\"},dbo_LU_ProjectMgrs,{\"ProjectMgrId\"},\"dbo_LU_ProjectMgrs\",JoinKind.LeftOuter),",
                "    #\"Expanded dbo_LU_ProjectMgrs\" = Table.ExpandTableColumn(#\"Merged Queries\", \"dbo_LU_ProjectMgrs\", {\"NickName\"}, {\"NickName\"}),",
                "    #\"Grouped Rows\" = Table.Group(dbo_FA_ProjectForecastChanges, {\"ProjectId\"}, {{\"Revenue\", each List.Sum([Revenue]), type number}, {\"Cost\", each List.Sum([Cost]), type number}}),",
                "    #\"Merged Queries1\" = Table.NestedJoin(#\"Expanded dbo_LU_ProjectMgrs\",{\"ProjectId\"},#\"Grouped Rows\",{\"ProjectId\"},\"Grouped Rows\",JoinKind.LeftOuter),",
                "    #\"Expanded Grouped Rows\" = Table.ExpandTableColumn(#\"Merged Queries1\", \"Grouped Rows\", {\"Revenue\", \"Cost\"}, {\"Revenue\", \"Cost\"}),",
                "    #\"Filtered Rows\" = Table.SelectRows(#\"Expanded Grouped Rows\", each ([CompanyId] = CompanyId)),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Filtered Rows\",{\"ProjectNo\", \"Project\", \"ParentProjectNo\", \"PlanStart\", \"PlanFinish\", \"ActualStart\", \"ActualFinish\", \"SalesmenId\", \"ProjectCateoryId\", \"CustomerId\", \"DepartmentId\", \"CompanyId\", \"ProjectRef\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "NyeKontoer",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "KontoBeskrivelse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7d39ff32-d77c-4e5f-8727-af7638595fb0",
            "sourceColumn": "KontoBeskrivelse",
            "summarizeBy": "none"
          },
          {
            "name": "KontoLnk1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7ca14f8a-a17d-4309-9f4f-dd5a0f482a45",
            "sourceColumn": "KontoLnk1",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "4b8f5f2a-e254-422f-84d3-6ac03b26a653",
        "partitions": [
          {
            "name": "NyeKontoer-24a616d6-9528-4b96-b60b-0f8888837c79",
            "mode": "import",
            "queryGroup": "Hjelpetabeller",
            "source": {
              "expression": [
                "let",
                "",
                "",
                "    SelskapsKontoplan = Table.NestedJoin(SQL_ChartOfAccounts,{\"FirmaId\"},SQL_Company,{\"InfoEasyId\"},\"sqlTbl2\",JoinKind.Inner),",
                "    #\"Expanded sqlTbl2\" = Table.ExpandTableColumn(SelskapsKontoplan, \"sqlTbl2\", {\"Company\", \"CompanyId\"}, {\"Company\", \"CompanyId\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Expanded sqlTbl2\",{{\"KontoId\", type text}, {\"Company\", type text}}),",
                "    Source1 = Table.NestedJoin(#\"Changed Type\",{\"Company\",\"KontoId\"},SQL_ReportingCOA,{\"SelskapsId\",\"Konto\"},\"Kontoplan\",JoinKind.LeftAnti),",
                "    #\"Added Custom\" = Table.AddColumn(Source1, \"KontoLnk1\", each Text.From([CompanyId])&\"-\"&Text.From([KontoId])),",
                "    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"KontoBeskrivelse\", each Text.From([KontoId])&\" - \"&Text.From([Konto])),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom1\",{\"FirmaId\", \"Type\", \"KontoLnk\", \"Company\", \"CompanyId\", \"Kontoplan\", \"KontoId\", \"Konto\"})",
                "",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProPrognose",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "CompanyId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8d694bdd-d045-4509-bea9-b8b751fcf880",
            "sourceColumn": "CompanyId",
            "summarizeBy": "none"
          },
          {
            "name": "CostChange",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "d96c495e-c616-4b13-9c5a-b2faaacb074d",
            "sourceColumn": "CostChange",
            "summarizeBy": "sum"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "d1aadba4-8a35-486a-bdd3-e7e9f5580138",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "Hovedarbeidsprosjekt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ea05f5cc-1c53-44d0-a455-e5b0c86b9114",
            "sourceColumn": "Hovedarbeidsprosjekt",
            "summarizeBy": "none"
          },
          {
            "name": "PlanSlutt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "187a81ca-77ee-4f02-81c6-79925e801796",
            "sourceColumn": "PlanSlutt",
            "summarizeBy": "none"
          },
          {
            "name": "PlanStart",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "5e94fa03-4436-4c7e-8c3e-ba3c12ebd7b5",
            "sourceColumn": "PlanStart",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjektLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ad23b666-fc6e-48f0-ab58-2f6bb64be1fa",
            "sourceColumn": "ProsjektLnk",
            "summarizeBy": "none"
          },
          {
            "name": "RevenueChange",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "6f734576-2ed4-4bdb-a389-34cbf488f58b",
            "sourceColumn": "RevenueChange",
            "summarizeBy": "sum"
          },
          {
            "name": "Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "83b136af-1c5b-48f5-ae7e-c7e0e48ce9d2",
            "sourceColumn": "Type",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "3e23fd87-7094-4c83-9a9b-9afff855ada7",
        "measures": [
          {
            "name": "MaxDate",
            "expression": "CLOSINGBALANCEMONTH(MAX(ProPrognose[PlanSlutt]),Kalender[Dato])",
            "formatString": "General Date",
            "lineageTag": "95bde34b-d5dd-47ab-bd3f-fe63fe79e8bf"
          }
        ],
        "partitions": [
          {
            "name": "ProPrognose-af242314-e067-49ba-bed4-bc7dc85957bf",
            "mode": "import",
            "queryGroup": "Fakta",
            "source": {
              "expression": [
                "let",
                "//Per",
                "    #\"_1Merged Queries1\" = Table.NestedJoin(SQL_Forecast,{\"Company\"},SQL_Company,{\"Company\"},\"Added Custom3\",JoinKind.Inner),",
                "    #\"_Expanded Added Custom3\" = Table.ExpandTableColumn(#\"_1Merged Queries1\", \"Added Custom3\", {\"CompanyId\"}, {\"CompanyId\"}),",
                "    #\"_Changed Type\" = Table.TransformColumnTypes(#\"_Expanded Added Custom3\",{{\"Date\", type date}, {\"ProsjektId\", type text}}),",
                "    Custom1 = Table.AddColumn(#\"_Changed Type\", \"SortSales\", each if [Version] = \"Sales\" then 0 else 1),",
                "    #\"Renamed Columns\" = Table.RenameColumns(Custom1,{{\"Inntekter\", \"RevenueChange\"}, {\"Kostnader\", \"CostChange\"}}),",
                "#\"_Added Custom2\" = Table.AddColumn(#\"Renamed Columns\", \"Filter\", each [RevenueChange]*[RevenueChange]+[CostChange]*[CostChange]),",
                "    #\"_1Added Custom4\" = Table.AddColumn(#\"_Added Custom2\", \"ProsjektLnk\", each Text.From([CompanyId])&\"-\"&Text.From([ProsjektId])),",
                "    #\"_Filtered Rows\" = Table.SelectRows(#\"_1Added Custom4\", each ([Filter] <> 0)),",
                "    #\"_1Removed Columns1\" = Table.RemoveColumns(#\"_Filtered Rows\",{\"Filter\", \"Company\", \"ProsjektId\", \"Version\", \"SortSales\"}),",
                "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"_1Removed Columns1\",{{\"Date\", type date}, {\"CompanyId\", Int64.Type}, {\"RevenueChange\", type number}, {\"CostChange\", type number}, {\"ProsjektLnk\", type text}, {\"PlanStart\", type date}, {\"PlanSlutt\", type date}}),",
                "    #\"Inserted Day\" = Table.AddColumn(#\"Changed Type1\", \"Type\", each if Date.Day([Date]) = 1 then \"Kalkyle\" else \"Prognose\", type text),",
                "    #\"Inserted Year\" = Table.AddColumn(#\"Inserted Day\", \"Year\", each if Date.Year([Date]) < SisteAar - AntallAar then #date(SisteAar - AntallAar,1,Date.Day([Date])) else [Date], Int64.Type),",
                "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Inserted Year\",{\"Date\"}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns1\",{{\"Year\", \"Date\"}}),",
                "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Renamed Columns1\",{{\"Date\", type date}})",
                "in",
                "    #\"Changed Type2\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProjectForecast",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Cost",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "578b4c2f-c533-4a41-a276-f92f9d3d0549",
            "sourceColumn": "Cost",
            "summarizeBy": "sum"
          },
          {
            "name": "CostAcc",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "179be7e4-ad48-49d9-a51d-a6cfd0f7c609",
            "sourceColumn": "CostAcc",
            "summarizeBy": "sum"
          },
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "0cbc3a9b-5bd7-49c8-a621-9536fe8ba7a4",
            "sourceColumn": "Date",
            "summarizeBy": "none"
          },
          {
            "name": "Hovedarbeidsprosjekt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "408d43ff-6bc3-47ad-ad9f-e8306fc8b1d3",
            "sourceColumn": "Hovedarbeidsprosjekt",
            "summarizeBy": "none"
          },
          {
            "name": "Revenue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "128d7923-aa92-4a89-a224-b0110c146f5a",
            "sourceColumn": "Revenue",
            "summarizeBy": "sum"
          },
          {
            "name": "RevenueAcc",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "45359b6b-5e72-4c86-aaf1-b021ec08c071",
            "sourceColumn": "RevenueAcc",
            "summarizeBy": "sum"
          }
        ],
        "lineageTag": "300b3c5d-bb6f-414b-9a70-620d532bfbef",
        "partitions": [
          {
            "name": "ProjectForecast-8fcff79f-c7b4-4a4f-8ac3-cdbff06097bd",
            "mode": "import",
            "queryGroup": "WorkInProgress",
            "source": {
              "expression": [
                "let",
                "    Source = Table.Combine({ProjectRevenueForecast, ProjectCostForecast}),",
                "    #\"Grouped Rows\" = Table.Group(Source, {\"Hovedarbeidsprosjekt\", \"Date\"}, {{\"Revenue\", each List.Sum([Revenue]), type number}, {\"RevenueAcc\", each List.Sum([RevenueAcc]), type number}, {\"Cost\", each List.Sum([Cost]), type number}, {\"CostAcc\", each List.Sum([CostAcc]), type number}})",
                "in",
                "    #\"Grouped Rows\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Prosjekt",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Adresse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "98700830-ef5f-46d6-a344-5d62a9f08ad6",
            "sourceColumn": "Adresse",
            "summarizeBy": "none"
          },
          {
            "name": "Avdeling",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b68e1fd8-c247-46a1-a47c-fe2a1d561d31",
            "sourceColumn": "Avdeling",
            "summarizeBy": "none"
          },
          {
            "name": "CompanyId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6009c566-03b1-4401-aa75-0264660f1531",
            "sourceColumn": "CompanyId",
            "summarizeBy": "count"
          },
          {
            "name": "DG",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "a6990227-4cce-44be-8a06-bee01e876b15",
            "sourceColumn": "DG",
            "summarizeBy": "sum"
          },
          {
            "name": "DP Beskrivelse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6eedba0d-e70e-4cca-abc0-c81cf8650df3",
            "sourceColumn": "DP Beskrivelse",
            "summarizeBy": "none"
          },
          {
            "name": "Delprosjekt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d48bd449-9e42-44cb-bf8d-c62321efc3ce",
            "sourceColumn": "Delprosjekt",
            "summarizeBy": "none"
          },
          {
            "name": "DelprosjektNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b7e39e90-1db6-4f8c-8d14-34f882b58b79",
            "sourceColumn": "DelprosjektNummer",
            "summarizeBy": "none"
          },
          {
            "name": "FerdigDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "4406b5de-5e4c-4927-b5e1-8b6ddffb8d58",
            "sourceColumn": "FerdigDato",
            "summarizeBy": "none"
          },
          {
            "name": "FriTekst2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f8568cc1-c2b8-410d-a4a1-b629f942ff75",
            "sourceColumn": "FriTekst2",
            "summarizeBy": "none"
          },
          {
            "name": "FriTekst3",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "1372a6a5-3cd7-4cca-b386-0f6f4709ad3b",
            "sourceColumn": "FriTekst3",
            "summarizeBy": "none"
          },
          {
            "name": "HP Beskrivelse",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "65c6b3af-b87d-4b4c-b591-2b6f0d042789",
            "sourceColumn": "HP Beskrivelse",
            "summarizeBy": "none"
          },
          {
            "name": "HovedArbeidProsjektNr",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "8ff57d83-c769-48be-8e1f-2550a94b1776",
            "sourceColumn": "HovedArbeidProsjektNr",
            "summarizeBy": "none"
          },
          {
            "name": "HovedProsjekt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "95918230-6479-437e-ba2f-4b4b2f18cb73",
            "sourceColumn": "HovedProsjekt",
            "summarizeBy": "none"
          },
          {
            "name": "HovedProsjektNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7d3012cb-45a3-4af3-8d8b-2ea7f6dc2809",
            "sourceColumn": "HovedProsjektNummer",
            "summarizeBy": "none"
          },
          {
            "name": "KundeNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "6fe4302b-e152-4335-b5b0-3138f1cea205",
            "sourceColumn": "KundeNummer",
            "summarizeBy": "sum"
          },
          {
            "name": "OrdreDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "175316ff-6384-4d90-9748-ff48a1525d3a",
            "sourceColumn": "OrdreDato",
            "summarizeBy": "none"
          },
          {
            "name": "OrdreVerdi",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "618ff1f3-7ced-42da-aef9-fd8a580c12ac",
            "sourceColumn": "OrdreVerdi",
            "summarizeBy": "sum"
          },
          {
            "name": "OrgVarighet",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d547c8c9-5fb4-4cf5-af3b-a1df525f88ec",
            "sourceColumn": "OrgVarighet",
            "summarizeBy": "sum"
          },
          {
            "name": "PlanFerdigDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "60befa33-515c-4937-a3e8-5f22eff11c5d",
            "sourceColumn": "PlanFerdigDato",
            "summarizeBy": "none"
          },
          {
            "name": "ProjectId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d4faa5c2-91ad-466f-86e2-4eab050b6834",
            "sourceColumn": "ProjectId",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjType",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ac8d9cb4-df9b-4f21-9e46-cf13f6d500f3",
            "sourceColumn": "ProsjType",
            "summarizeBy": "sum"
          },
          {
            "name": "Prosjekt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0dc6d69e-cdfc-4fca-a035-1d6179cf48ff",
            "sourceColumn": "Prosjekt",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjektLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "215efe9b-fe59-41a7-9adf-1ddc6b95cd15",
            "sourceColumn": "ProsjektLnk",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjektNummer",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2588f461-9d59-45a1-8341-9d1ce6da304a",
            "sourceColumn": "ProsjektNummer",
            "summarizeBy": "none"
          },
          {
            "name": "Prosjektleder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b1f46ed2-b27f-43bc-ba77-20bb8a954333",
            "sourceColumn": "Prosjektleder",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjektlederId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "03c24c92-1e08-4611-9ce3-de0327ffa6d0",
            "sourceColumn": "ProsjektlederId",
            "summarizeBy": "none"
          },
          {
            "name": "Selger",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "45589135-6c65-40ef-a627-cb99c98fad9a",
            "sourceColumn": "Selger",
            "summarizeBy": "none"
          },
          {
            "name": "SelgerId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "2ed853de-4f0e-4006-8fd6-fbae740827bd",
            "sourceColumn": "SelgerId",
            "summarizeBy": "none"
          },
          {
            "name": "StartDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "73fb2b22-b5bb-455f-9944-691fd423b6c9",
            "sourceColumn": "StartDato",
            "summarizeBy": "none"
          },
          {
            "name": "Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d5708b61-ec4b-4500-a214-7e4f95ed3cf9",
            "sourceColumn": "Status",
            "summarizeBy": "none"
          },
          {
            "name": "WIPfilter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "expression": "IF(ISBLANK(LOOKUPVALUE(ProPrognose[Hovedarbeidsprosjekt],ProPrognose[Hovedarbeidsprosjekt],Prosjekt[HovedArbeidProsjektNr])),0,1) ",
            "formatString": "0",
            "isDataTypeInferred": true,
            "lineageTag": "c2364e3c-38b8-4a41-926f-504923ea1a46",
            "summarizeBy": "sum",
            "type": "calculated"
          }
        ],
        "lineageTag": "68a97ca3-a026-4ea3-bdb6-d1f0948827a9",
        "measures": [
          {
            "name": "Varighet",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "(MAX(Prosjekt[PlanFerdigDato])-MAX(Prosjekt[StartDato]))*1",
            "lineageTag": "66ab9c93-fc95-4b2b-8139-dbb2bd2d9521"
          },
          {
            "name": "Valgt HP",
            "expression": "SELECTEDVALUE(Prosjekt[HP Beskrivelse])",
            "lineageTag": "8f556f90-854b-4077-af16-35201f834b27"
          },
          {
            "name": "Tull",
            "expression": "CALCULATE(COUNT(HpPrognose[HovedArbeidProsjektNr]),ALLEXCEPT(Prosjekt,Prosjekt[HovedArbeidProsjektNr]))",
            "formatString": "0",
            "lineageTag": "1dcaf352-b26b-4aeb-a6b1-3274ee320049"
          }
        ],
        "partitions": [
          {
            "name": "Prosjekt",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "   ",
                "/*",
                "//SharePoint",
                "",
                "    SharePoint = SharePoint.Tables(SharePointSite1, [ApiVersion = 15]),",
                "    Company = SharePoint{[Id=\"c6c05096-82a1-486e-af74-d9aca84f2740\"]}[Items],",
                "    SelectColumns = Table.RemoveColumns(Company,{\"FileSystemObjectType\", \"Id\", \"ServerRedirectedEmbedUri\", \"ServerRedirectedEmbedUrl\", \"ContentTypeId\", \"ComplianceAssetId\", \"Modified\", \"Created\", \"AuthorId\", \"EditorId\", \"OData__UIVersionString\", \"Attachments\", \"GUID\", \"FirstUniqueAncestorSecurableObject\", \"RoleAssignments\", \"Activities\", \"AttachmentFiles\", \"ContentType\", \"GetDlpPolicyTip\", \"FieldValuesAsHtml\", \"FieldValuesAsText\", \"FieldValuesForEdit\", \"File\", \"Folder\", \"LikedByInformation\", \"ParentList\", \"Properties\", \"Versions\", \"Author\", \"Editor\", \"ID\"}),",
                "    RenameColumns = Table.RenameColumns(SelectColumns,{{\"Title\", \"Company\"}}),",
                "",
                "//SQL",
                "",
                "    table1 = \"Prosjekter\",",
                "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
                "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
                "*/",
                "//Procedure",
                "",
                "    Source = Sql.Database(SQLserver1, SQLdatabase1, [Query=\"EXEC NewProjectsHallmaker\"]),",
                "",
                "    #\"Merged Queries\" = Table.NestedJoin(Table.SelectRows(SQL_Projects, each [Prosjekt] <> Source[Filter]{0}),{\"FirmaId\"},SQL_Company,{\"InfoEasyId\"},\"Companies\",JoinKind.Inner),",
                "    #\"Expanded Companies\" = Table.ExpandTableColumn(#\"Merged Queries\", \"Companies\", {\"CompanyId\"}, {\"CompanyId\"}),",
                "    #\"Sorted Rows1\" = Table.Sort(#\"Expanded Companies\",{{\"ProsjektId\", Order.Ascending}}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Sorted Rows1\",{{\"ProsjektLnk\", \"ProsjektLnkOld\"}}),",
                "",
                "    #\"Added Custom\" = Table.AddColumn(#\"Renamed Columns\", \"ProsjektLnk\", each Text.From([CompanyId])&\"-\"&Text.From([ProsjektId])),",
                "    filterColumns = Table.RemoveColumns(#\"Added Custom\",{\"FirmaId\", \"ProsjektLnkOld\"}),",
                "    columns2Norwegian = Table.RenameColumns(filterColumns,{{\"ProsjektId\", \"ProsjektNummer\"}}),",
                "    #\"Added Custom1\" = Table.AddColumn(columns2Norwegian, \"Custom\", each if [HovedArbeidProsjektNr] <> null then [HovedArbeidProsjektNr] else [ProsjektNummer]),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom1\",{\"HovedArbeidProsjektNr\"}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"HovedArbeidProsjektNr\"}}),",
                "    #\"Sorted Rows\" = Table.Sort(#\"Renamed Columns1\",{{\"HovedArbeidProsjektNr\", Order.Ascending},{\"ProsjektLnk\", Order.Ascending}}),",
                "    #\"Replaced Value\" = Table.ReplaceValue(#\"Sorted Rows\",\",,,,,,,,,,,,,,,,,,,,\",\"SLETT\",Replacer.ReplaceText,{\"ProsjektNummer\"}),",
                "    #\"Filtered Rows1\" = Table.SelectRows(#\"Replaced Value\", each ([ProsjektNummer] <> \"SLETT\")),",
                "    #\"Added Custom2\" = Table.AddColumn(#\"Filtered Rows1\", \"HovedProsjekt\", each if [Prosjekt] = null then \"\" else if [ProsjektNummer] = [HovedArbeidProsjektNr] then [Prosjekt] else null),",
                "    #\"Filled Down\" = Table.FillDown(#\"Added Custom2\",{\"HovedProsjekt\"}),",
                "    #\"Added Custom3\" = Table.AddColumn(#\"Filled Down\", \"HP Beskrivelse\", each if Text.Length([HovedProsjekt])>0 then [HovedArbeidProsjektNr]&\" - \"&[HovedProsjekt] else [HovedArbeidProsjektNr]),",
                "    #\"Added Custom4\" = Table.AddColumn(#\"Added Custom3\", \"Delprosjekt\", each Text.AfterDelimiter([Prosjekt], \"_\", {0, RelativePosition.FromEnd})),",
                "    #\"Added Custom5\" = Table.AddColumn(#\"Added Custom4\", \"DelprosjektNummer\", each Text.AfterDelimiter([ProsjektNummer], \"-\", {0, RelativePosition.FromEnd})),",
                "    #\"Added Custom6\" = Table.AddColumn(#\"Added Custom5\", \"DP Beskrivelse\", each if [HovedArbeidProsjektNr] = [DelprosjektNummer] then \" \"&[DelprosjektNummer] &\"   \"&[Delprosjekt] else [DelprosjektNummer]&\"-\"&[Delprosjekt], type text),",
                "    #\"Added Custom7\" = Table.AddColumn(#\"Added Custom6\", \"OrgVarighet\", each if [StartDato] = null then 0 else if [PlanFerdigDato] = null then 0 else Number.From([PlanFerdigDato])-Number.From([StartDato])),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Added Custom7\",{{\"StartDato\", type date}, {\"PlanFerdigDato\", type date}, {\"FerdigDato\", type date}, {\"OrgVarighet\", Int64.Type}, {\"HovedArbeidProsjektNr\", type text}, {\"HP Beskrivelse\", type text}, {\"HovedProsjekt\", type text}, {\"ProsjektLnk\", type text}, {\"Avdeling\", type text}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProsjektKPI",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "columns": [
          {
            "name": "ProsjektKPI",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "bdd42834-7d11-4ce4-a1bd-e86f1bbf9139",
            "sourceColumn": "ProsjektKPI",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "1e834e78-a6aa-4015-b8e8-e8b3088e5551",
        "measures": [
          {
            "name": "Kostnadsprognose",
            "expression": "CALCULATE([ProgKostEndring],FILTER(ALL(Kalender),Kalender[Dato]<=MAX(Kalender[Dato])))",
            "formatString": "#,0",
            "lineageTag": "01bcf5dd-21b5-4e94-9715-a8d3f51b6d7d"
          },
          {
            "name": "Opptjent %",
            "expression": "DIVIDE([KostAkk],[Kostnadsprognose])",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "a1d46eae-4abf-4e92-9dbb-f71d88bd4552"
          },
          {
            "name": "Inntektsprognose",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE([ProgInntEndring],FILTER(ALL(Kalender),Kalender[Dato]<=MAX(Kalender[Dato])))",
            "formatString": "#,0",
            "lineageTag": "d2ed9a68-9661-438e-9654-f38de0f53b07"
          },
          {
            "name": "ProInntektIndikator",
            "expression": [
              "",
              "",
              "VAR Up =",
              "    UNICHAR ( 9650 )",
              "VAR Down =",
              "    UNICHAR ( 9660 )",
              "    ",
              "VAR Test = [ProgInntEndring]",
              "    ",
              "        ",
              "RETURN ",
              "    ",
              "    IF(HASONEVALUE(Prosjekt[HovedArbeidProsjektNr]),",
              "    MAXX(VALUES(ProPrognose[Hovedarbeidsprosjekt]),",
              "    IF ( Test > 1 , Up , IF(Test < -1 , Down , BLANK()))) ",
              "    ,BLANK())"
            ],
            "lineageTag": "824de53b-7a1c-4477-92e7-76580eaa8cf4"
          },
          {
            "name": "DG% prognose",
            "expression": "DIVIDE([Inntektsprognose]-[Kostnadsprognose],[Inntektsprognose])",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "2505e721-9bfc-4719-b01b-0a6672751985"
          },
          {
            "name": "ProDGIndikator",
            "expression": [
              "",
              "",
              "VAR Up =",
              "    UNICHAR ( 9650 )",
              "VAR Down =",
              "    UNICHAR ( 9660 )",
              "VAR Test =     ",
              "    [ProgDGEndring]",
              "RETURN ",
              "    ",
              "    IF(HASONEVALUE(Prosjekt[HovedArbeidProsjektNr]),",
              "    MAXX(VALUES(ProPrognose[Hovedarbeidsprosjekt]),",
              "    IF ( Test > 1 , Up , IF ( Test < -1 , Down , BLANK()))),BLANK())"
            ],
            "lineageTag": "ebf767d7-13a8-443a-a855-a9d513486cb0"
          },
          {
            "name": "ProgDGEndring",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "ROUND(DIVIDE([Inntektsprognose]-[Kostnadsprognose],[Inntektsprognose])*10000,0)-CALCULATE( ROUND(DIVIDE([Inntektsprognose]-[Kostnadsprognose],[Inntektsprognose])*10000,0),DATEADD(Kalender[Dato],-1,MONTH))",
            "lineageTag": "482ad7ca-c585-480d-b696-4b80675369a4"
          },
          {
            "name": "Bidrag",
            "expression": [
              "",
              "SWITCH (",
              "    MAX ( ProsjektStatus[Order] ),",
              "    \"1\", [BidragPer] + [VIAendringMnd],",
              "    \"2\", [BidragHIÅ] + [VIAendringYtd],",
              "    \"3\", [FakturertAkk] - [KostAkk] + [VIAakkumulert] - [ForskuddAkk],",
              "    \"4\", [Inntektsprognose]-[Kostnadsprognose] - ([FakturertAkk] - [KostAkk] + [VIAakkumulert] - [ForskuddAkk])",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "078ec09a-c77b-48f2-b5ea-0f17f1b2f8c8"
          },
          {
            "name": "Inntekt",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "",
              "SWITCH (",
              "    MAX ( ProsjektStatus[Order] ),",
              "    \"1\", [FaktturertPer] + [VIAendringMnd] - [ForskuddPer],",
              "    \"2\", [FakturertHIÅ] + [VIAendringYtd],",
              "    \"3\", [FakturertAkk] + [VIAakkumulert] - [ForskuddAkk],",
              "    \"4\", [Inntektsprognose] - ([FakturertAkk] + [VIAakkumulert] - [ForskuddAkk]),",
              "    [FakturertAkk] + [VIAakkumulert] - [ForskuddAkk]",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "7b777776-9c79-456b-9ba5-e820ee693e55"
          },
          {
            "name": "DG %",
            "expression": "DIVIDE([Bidrag],[Inntekt])",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "b45e17d2-3961-4b84-a894-7013933caf55"
          },
          {
            "name": "Fakturert",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "",
              "SWITCH (",
              "    MAX ( ProsjektStatus[Order] ),",
              "    \"1\", [FaktturertPer],",
              "    \"2\", [FakturertHIÅ],",
              "    \"3\", [FakturertAkk]",
              "    ",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "144abbbe-4c8d-4bdc-af12-9bcd2e924ef0"
          },
          {
            "name": "Kostnad",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "",
              "SWITCH (",
              "    MAX ( ProsjektStatus[Order] ),",
              "    \"1\", [KostPer],",
              "    \"2\", [KostHIÅ],",
              "    \"3\", [KostAkk]",
              "    ",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "9f1e8a83-c16c-43c6-8e56-ad9130e4da61"
          },
          {
            "name": "InntektsprognoseAll",
            "expression": "CALCULATE([ProgInntEndring],ALL(Kalender))",
            "formatString": "0",
            "lineageTag": "c007857c-2d47-4eeb-8256-fbc451826794"
          },
          {
            "name": "Inntektsbudsjett",
            "expression": "CALCULATE([ProgInntEndring],ALL(Kalender),ProPrognose[Type]=\"Kalkyle\")",
            "formatString": "#,0",
            "lineageTag": "732f8a77-a2e6-45a3-b4fc-a07a91e84b29"
          },
          {
            "name": "Kostnadsbudsjett",
            "expression": "CALCULATE([ProgKostEndring],ALL(Kalender),ProPrognose[Type]=\"Kalkyle\")",
            "formatString": "#,0",
            "lineageTag": "438f2b76-a40e-4797-8656-f3062df94501"
          },
          {
            "name": "DB budsjett",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[Inntektsbudsjett]-[Kostnadsbudsjett]",
            "formatString": "#,0",
            "lineageTag": "d469584b-230f-495f-92a9-24b6aca9352d"
          },
          {
            "name": "DG budsjett",
            "expression": "DIVIDE([DB budsjett],[Inntektsbudsjett])",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "98d84d1e-f697-40bf-97c7-7266d8003817"
          },
          {
            "name": "Rest %",
            "expression": "1-DIVIDE([KostAkk]+[EyeShare],[Kostnadsprognose]) ",
            "formatString": "0\\ %;-0\\ %;0\\ %",
            "lineageTag": "d56ef13a-27ba-4b87-8ec6-471f9bcd1325"
          },
          {
            "name": "DB Prognose",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[Inntektsprognose]-[Kostnadsprognose]",
            "formatString": "#,0",
            "lineageTag": "f9871840-7386-43da-9634-6942e538d965"
          },
          {
            "name": "VIA",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "",
              "SWITCH (",
              "    MAX ( ProsjektStatus[Order] ),",
              "    \"1\", [VIAendringMnd],",
              "    \"2\", [VIAendringYtd],",
              "    \"3\", [VIAakkumulert],",
              "    \"4\", - [VIAakkumulert]",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "0a399f40-e59a-4f6d-a696-d7e4f7a27207"
          },
          {
            "name": "Inntektsprognose2",
            "expression": [
              "CALCULATE (",
              "            - SUM ( ProPrognose[RevenueChange] ),",
              "            DATESBETWEEN (",
              "                Kalender[Dato],",
              "                FIRSTDATE ( ProPrognose[Date]+0 ),",
              "                LASTDATE ( Kalender[Dato] )",
              "            )",
              "        ) / MIN(Faktorer[Faktor])"
            ],
            "formatString": "0",
            "lineageTag": "4fc6db67-eba8-4925-97c7-ad188de45dd7"
          },
          {
            "name": "InntektTY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[FakturertHIÅ] + [VIAendringYtd]",
            "lineageTag": "0031c1ea-faea-4a55-997c-6bc1454d8fbd"
          },
          {
            "name": "Inntektsavvik",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[Inntektsprognose]-[Inntektsbudsjett]",
            "formatString": "#,0",
            "lineageTag": "fa9490f0-b986-4754-a503-54a7f3f7b720"
          },
          {
            "name": "Påløpt",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[KostAkk]+[EyeShare]",
            "formatString": "#,0",
            "lineageTag": "324354a5-fb5e-4ae9-9e6b-fbec759a3def"
          },
          {
            "name": "Rest",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[Kostnadsprognose]-[Påløpt]",
            "formatString": "#,0",
            "lineageTag": "dc62e301-fad4-45ce-991d-5373c6f093bc"
          },
          {
            "name": "ProgVsBud",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[Kostnadsbudsjett]-[Kostnadsprognose]",
            "formatString": "#,0",
            "lineageTag": "1eadc168-caf7-498f-a417-192fd0435f9d"
          },
          {
            "name": "DG% fper",
            "expression": "CALCULATE([DG %],DATEADD(Kalender[Dato],-1,MONTH))",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "f424e9ce-4d36-4e3f-9145-064d7f85605b"
          },
          {
            "name": "Fakturert fper",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE([Fakturert],DATEADD(Kalender[Dato],-1,MONTH))",
            "formatString": "#,0",
            "lineageTag": "59092cc1-b025-4e23-b60f-bec93e47b0bf"
          },
          {
            "name": "Faktura reserve",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "ROUND([Inntektsprognose]-[Fakturert],2)",
            "formatString": "#,0",
            "lineageTag": "d2d54909-9394-4610-b55f-45b850c17bc0"
          },
          {
            "name": "Inntekt fper",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE([Inntekt],DATEADD(Kalender[Dato],-1,MONTH))",
            "formatString": "#,0",
            "lineageTag": "25f88dc8-4ce1-4d07-aa76-68de90dc135d"
          },
          {
            "name": "Inntektsreserve",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[Inntektsprognose]-[Inntekt]",
            "formatString": "#,0",
            "lineageTag": "824bbb4e-804c-44f0-95f7-06751b3ebb97"
          },
          {
            "name": "Bidrag fper",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE([Bidrag],DATEADD(Kalender[Dato],-1,MONTH))",
            "formatString": "#,0",
            "lineageTag": "6ec8d77c-5ec1-4dc1-8fbb-d6597759b8e4"
          },
          {
            "name": "Ferdig fper",
            "expression": "CALCULATE([Opptjent %],DATEADD(Kalender[Dato],-1,MONTH))",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "0371c252-472b-4bb2-bab4-e708732a6637"
          },
          {
            "name": "Ferdig rest",
            "expression": "1-[Opptjent %]",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "19c9341b-72f5-4a39-a0a2-c2af829bde95"
          },
          {
            "name": "DB Avvik",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "",
              "VAR Down =",
              "    UNICHAR ( 128681 )",
              "VAR Up =",
              "    UNICHAR ( 128176 )",
              "RETURN",
              "    IF ( [DB Prognose] - [DB budsjett] >= 0 , [DB Prognose] - [DB budsjett] ,CONCATENATE(Down,CONCATENATE(\" \",FORMAT([DB Prognose] - [DB budsjett],\"# ### ##0\"))))"
            ],
            "formatString": "#,0",
            "lineageTag": "184c8d50-6e6f-452d-9604-a2c9feef3939"
          },
          {
            "name": "MaxDato",
            "expression": "MAX(Kalender[Dato])",
            "formatString": "General Date",
            "lineageTag": "069d378e-b5e7-4579-b572-a88a1c272a6a"
          }
        ],
        "partitions": [
          {
            "name": "ProsjektKPI-a2cfa9ee-fb5b-4133-9e6f-b7eb25d7e77d",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = \"\"",
                "in",
                "    Source"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProsjektMeasures",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "columns": [
          {
            "name": "ProsjektMeasures",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "e5e0eecc-91c8-4be3-8404-754440e18a69",
            "sourceColumn": "ProsjektMeasures",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "23739c6a-4347-4464-824d-9223ef61cc30",
        "measures": [
          {
            "name": "ProgInntEndring",
            "expression": "DIVIDE(SUM(ProPrognose[RevenueChange]),[Rapportfaktor])",
            "formatString": "0",
            "lineageTag": "823905d7-8ea3-421e-b274-0917e5e09231"
          },
          {
            "name": "VIAendringMnd",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[VIAakkumulert]-CALCULATE([VIAakkumulert],DATEADD(Kalender[Dato],-1,MONTH))",
            "formatString": "#,0",
            "lineageTag": "def1114e-b7e6-4c00-9d99-98cd7a630f24"
          },
          {
            "name": "BidragPer",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[FaktturertPer]-[KostPer]",
            "lineageTag": "b8e79ad7-851d-4f10-833e-8a0025e008e9"
          },
          {
            "name": "BidragHIÅ",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "TOTALYTD([BidragPer],Kalender[Dato])",
            "lineageTag": "00909cba-175a-4031-8c0c-983715c17f4f"
          },
          {
            "name": "VIAendringYtd",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[VIAakkumulert]-CALCULATE([VIAakkumulert],FILTER(ALL(Kalender),Kalender[År]=MAX(Kalender[År])-1),Kalender[MndNo]=12)",
            "lineageTag": "fad9e3e4-7656-4ca6-9e81-0776610b844f"
          },
          {
            "name": "FakturertHIÅ",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "TOTALYTD([FaktturertPer],Kalender[Dato])",
            "lineageTag": "e9c3b552-b78f-40f9-9a92-f6d4795a473a"
          },
          {
            "name": "FaktturertPer",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "CALCULATE (",
              "                    SUMX (",
              "                        CALCULATETABLE ( VALUES ( Prosjekt[ProsjektNummer] ), Prosjekt[WIPfilter]=1),",
              "                        - [Regnskap] / MIN ( Faktorer[Faktor] )",
              "                    ),",
              "                    Kontoplan[Nivå2] = \"Inntekter\"",
              "                )",
              ""
            ],
            "formatString": "#,0",
            "lineageTag": "8070bf12-33eb-4d77-8194-26f18b7f3764"
          },
          {
            "name": "FakturertAkk",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE([FaktturertPer],FILTER(ALL(Kalender),Kalender[Dato]<=MAX(Kalender[Dato])))",
            "formatString": "#,0",
            "lineageTag": "71d69b8d-f543-4703-b4b8-ba82c04140a8"
          },
          {
            "name": "KostAkk",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE([KostPer],FILTER(ALL(Kalender),Kalender[Dato]<=MAX(Kalender[Dato])))",
            "formatString": "#,0",
            "lineageTag": "43fe7f45-f6ff-4dde-a195-e4de21e93817"
          },
          {
            "name": "KostPer",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": [
              "CALCULATE (",
              "            SUMX (",
              "                CALCULATETABLE ( VALUES ( Prosjekt[ProsjektNummer] ),Prosjekt[WIPfilter]=1), ",
              "                [Regnskap] / MIN ( Faktorer[Faktor] )",
              "            ),",
              "            Kontoplan[Rapport] = \"Resultat\",Kontoplan[Nivå1]<>\"Inntekter\"   ",
              "        )"
            ],
            "formatString": "#,0",
            "lineageTag": "188a4d38-1a65-47d5-b1ca-6bf1c512228f"
          },
          {
            "name": "KostHIÅ",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "TOTALYTD (",
              "            [KostPer],",
              "            Kalender[Dato]",
              "        )"
            ],
            "lineageTag": "75411373-00ce-4848-8ad2-5d11ac548505"
          },
          {
            "name": "ProgKostEndring",
            "expression": "DIVIDE(SUM(ProPrognose[CostChange]),Faktorer[Rapportfaktor])",
            "formatString": "0",
            "lineageTag": "dbb5749a-fc74-4da1-a919-fdf70af89d95"
          },
          {
            "name": "EyeShare",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "CALCULATE(DIVIDE(SUM(Regnskap[Belop2]),Faktorer[Rapportfaktor]),USERELATIONSHIP(Kalender[Dato],Regnskap[FakturaDato]))",
            "formatString": "#,0",
            "lineageTag": "7f5ba683-afbc-4684-b04e-f5f4a8919f63"
          },
          {
            "name": "Fakturabeløp",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[KostPer]+[EyeShare]",
            "lineageTag": "726dc401-7dd5-446b-b676-fc0965ac8016"
          },
          {
            "name": "Flagg",
            "expression": [
              "",
              "VAR Down =",
              "    UNICHAR ( 128681 )",
              "VAR Up =",
              "    UNICHAR ( 128176 )",
              "RETURN",
              "    IF ( ( [KostAkk]+[EyeShare] ) > ( [Kostnadsprognose] * 0.9) , IF ( ( [KostAkk]+[EyeShare] ) <= ( [Kostnadsprognose] ) , Down, CONCATENATE(Down, Down) ), \"\") "
            ],
            "lineageTag": "5ca73a4a-1a0a-480e-96d4-7e80988b1e01"
          },
          {
            "name": "Filter",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[Inntekt]*[Inntekt]+[Bidrag]*[Bidrag]",
            "lineageTag": "f8d1c175-48f8-4c89-a399-03923981f7f4"
          },
          {
            "name": "VIAakkumulert",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUMX(VALUES(Prosjekt[HovedArbeidProsjektNr]),[Inntektsprognose]*IF([Opptjent %]<=1,[Opptjent %],1)-[FakturertAkk]+[ForskuddAkk])",
            "formatString": "#,0",
            "lineageTag": "c778de9d-9749-4178-917b-b28a44952db0"
          },
          {
            "name": "TestMaxDte",
            "expression": "MAX((ProPrognose[Date]))",
            "formatString": "General Date",
            "lineageTag": "5c295fef-e62d-4b42-b86b-ee63efe605cb"
          },
          {
            "name": "FilterVIA",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "ROUNDDOWN([VIAakkumulert]*[VIAakkumulert]+[VIAendringMnd]*[VIAendringMnd],0)",
            "lineageTag": "48d39abc-153d-4d40-8a35-5ea2c7d593d1"
          },
          {
            "name": "KostPerOther",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "CALCULATE (",
              "            SUMX (",
              "                CALCULATETABLE ( VALUES ( Prosjekt[ProsjektNummer] ),Prosjekt[WIPfilter]=0), ",
              "                [Regnskap] / MIN ( Faktorer[Faktor] )",
              "            ),",
              "            Kontoplan[Rapport] = \"Resultat\",Kontoplan[Nivå1]<>\"Inntekter\"   ",
              "        )"
            ],
            "lineageTag": "5601cb84-30fc-4750-b19c-f0d7709fe25b"
          },
          {
            "name": "EyeShareTest",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "SUM(Regnskap[Belop2])",
            "lineageTag": "c9543722-d440-4bf4-aeff-393d99c55d13"
          },
          {
            "name": "Slett1",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CALCULATE([VIAakkumulert],FILTER(ALL(Kalender),Kalender[År]=MAX(Kalender[År])-1),Kalender[MndNo]=12)",
            "lineageTag": "0730a9ea-49eb-42b5-bf5e-c0716631c254"
          },
          {
            "name": "ForskuddPer",
            "expression": [
              "CALCULATE (",
              "                    SUMX (",
              "                        CALCULATETABLE ( VALUES ( Prosjekt[ProsjektNummer] ), Prosjekt[WIPfilter]=1),",
              "                        - [Regnskap] / MIN ( Faktorer[Faktor] )",
              "                    ),",
              "                    Kontoplan[Konto] = 398",
              "                )"
            ],
            "formatString": "#,0",
            "lineageTag": "3cf40fc5-df44-4f0e-aec7-7f6bd26c7717"
          },
          {
            "name": "ForskuddAkk",
            "expression": "CALCULATE([ForskuddPer],FILTER(ALL(Kalender),Kalender[Dato]<=MAX(Kalender[Dato])))",
            "formatString": "#,0",
            "lineageTag": "4a9ce22b-53ad-438d-84f1-26efc0927eaa"
          }
        ],
        "partitions": [
          {
            "name": "ProsjektMeasures-6327e255-3b50-4ef5-b88e-05c2fcc89e94",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = \"\"",
                "in",
                "    Source"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "ProsjektStatus",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "590518ba-fad8-4013-946b-4b58d824c0d4",
            "sourceColumn": "Order",
            "summarizeBy": "none"
          },
          {
            "name": "Statusperioder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ba78c1a3-2874-4a65-97cb-e300aa15e5b2",
            "sortByColumn": "Order",
            "sourceColumn": "Statusperioder",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "fe46f1e3-eeef-4a31-9ab9-ef6a9713bdea",
        "partitions": [
          {
            "name": "ProsjektStatus-388a10dd-925d-415d-a79d-77d1a7f2fded",
            "mode": "import",
            "queryGroup": "Hjelpetabeller",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WCkgtysxPSVXSUTJUitWJVvLILCnJzFHIVDi8tAgoaIQqWFCUX5yVml2SWgKUMwbLBaUWlwCF0/Pyi0GmmIAFA6DqFErySxJzQIpNlWJjAQ==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type text) meta [Serialized.Text = true]) in type table [Statusperioder = _t, Order = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Statusperioder\", type text}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Regnskap",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          },
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          }
        ],
        "columns": [
          {
            "name": "Aar",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "int64",
            "expression": "YEAR(Regnskap[Dato])",
            "isDataTypeInferred": true,
            "lineageTag": "641c7858-fb6e-4319-bd61-fa136151a632",
            "summarizeBy": "sum",
            "type": "calculated"
          },
          {
            "name": "Belop",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "double",
            "formatString": "#,0.00",
            "lineageTag": "f7c07c74-99a0-49fa-b9a4-090ce2bd57bd",
            "sourceColumn": "Belop",
            "summarizeBy": "sum"
          },
          {
            "name": "Belop2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "319c3026-ea22-4a0c-8dfe-e699962beb9c",
            "sourceColumn": "Belop2",
            "summarizeBy": "sum"
          },
          {
            "name": "BilagsId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataCategory": "Uncategorized",
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "4be9668b-acba-4b36-97cb-70af3f0f9e16",
            "sourceColumn": "BilagsId",
            "summarizeBy": "none"
          },
          {
            "name": "Dato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "2371041d-66e6-4c26-92a3-a44d52a3132c",
            "sourceColumn": "Dato",
            "summarizeBy": "none"
          },
          {
            "name": "Eyeshare",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataCategory": "WebUrl",
            "dataType": "string",
            "lineageTag": "c2164e7e-c815-4948-9138-ec898bbae8ab",
            "sourceColumn": "Eyeshare",
            "summarizeBy": "none"
          },
          {
            "name": "FakturaDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "changedProperties": [
              {
                "property": "DataType"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "lineageTag": "e6b54993-4c7e-4ee9-afcc-000510c9c50d",
            "sourceColumn": "FakturaDato",
            "summarizeBy": "none"
          },
          {
            "name": "FakturaId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d4d5dac4-9012-4013-98db-1f2bc1c5c774",
            "sourceColumn": "FakturaId",
            "summarizeBy": "none"
          },
          {
            "name": "KontoLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "b62fefff-78c7-4936-9d62-fc2f2a5c95bd",
            "sourceColumn": "KontoLnk",
            "summarizeBy": "none"
          },
          {
            "name": "KundeLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataCategory": "Uncategorized",
            "dataType": "string",
            "lineageTag": "b8f4b958-ea2c-4bcb-a195-b0bf8c0026da",
            "sourceColumn": "KundeLnk",
            "summarizeBy": "none"
          },
          {
            "name": "LevLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataCategory": "Uncategorized",
            "dataType": "string",
            "lineageTag": "58e98a02-2d6a-4222-a49f-1884a864cada",
            "sourceColumn": "LevLnk",
            "summarizeBy": "none"
          },
          {
            "name": "OldSelskapsId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "11471886-a89a-4e21-8bf2-a6127fa089b4",
            "sourceColumn": "OldSelskapsId",
            "summarizeBy": "none"
          },
          {
            "name": "PostDato",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "7a792272-69c0-434e-b8fd-ea913cf4634c",
            "sourceColumn": "PostDato",
            "summarizeBy": "none"
          },
          {
            "name": "ProsjektLnk",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d93c8449-bc06-497b-8e89-c2e258cf70f7",
            "sourceColumn": "ProsjektLnk",
            "summarizeBy": "none"
          },
          {
            "name": "SelskapsId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "78c01311-e78a-492b-9a5a-0c5767326660",
            "sourceColumn": "SelskapsId",
            "summarizeBy": "none"
          },
          {
            "name": "SettId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "expression": "\"Act\"",
            "isDataTypeInferred": true,
            "lineageTag": "c08fc187-2f5e-449a-b073-06b3f23612f4",
            "summarizeBy": "none",
            "type": "calculated"
          }
        ],
        "lineageTag": "53a5aca6-e54d-4b63-a765-f03351ea0bba",
        "measures": [
          {
            "name": "Regnskap",
            "expression": "SUM(Regnskap[Belop])",
            "formatString": "#,0",
            "lineageTag": "5675951c-fc86-4804-95f2-716566650a33"
          },
          {
            "name": "RegnskapUtenFortegn",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "SUMX(Regnskap,Regnskap[Belop]*RELATED(Kontoplan[Fortegn]))",
            "lineageTag": "290a4029-2baa-426f-ad04-edee257ea570"
          },
          {
            "name": "CompanyId_",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CONCATENATE(\"\",MAX(Regnskap[SelskapsId]))",
            "lineageTag": "3b99d48b-393e-426b-be9d-d7c0da839990"
          },
          {
            "name": "Antall av SelskapsId",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "COUNTA('Regnskap'[SelskapsId])",
            "lineageTag": "a2ee99b4-1981-4e48-9c89-4df117505ac0"
          },
          {
            "name": "Test99",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "CALCULATE (",
              "        SUM ( Regnskap[Belop] ),",
              "        CALCULATETABLE ( VALUES ( Prosjekt[HovedArbeidProsjektNr] ), ProPrognose )",
              "    )"
            ],
            "lineageTag": "2dec7091-b501-4e22-b2ef-ba32f5adb139"
          }
        ],
        "partitions": [
          {
            "name": "Regnskap",
            "mode": "import",
            "queryGroup": "Fakta",
            "source": {
              "expression": [
                "let",
                "",
                "//Procedure",
                "    FilterSelskap = Table.NestedJoin(SQL_Company,{\"InfoEasyId\"}, SQL_GeneralLedger,{\"FirmaId\"},\"SelskapsId\",JoinKind.Inner),",
                "    HentData = Table.ExpandTableColumn(FilterSelskap, \"SelskapsId\", {\"HovedbokId\", \"KontoId\", \"BilagsNummer\", \"Dato\", \"DimensjonA\", \"DimensjonB\", \"DimensjonC\", \"DimensjonD\", \"ProsjektId\", \"MomsKode\", \"MotkontoType\", \"MotKonto\", \"NettoBelop\", \"TekstKode\", \"Tekst\", \"Periode\", \"Aar\", \"BunkeNummer\", \"RegistreringId\", \"Mengde\", \"KontoLnk\", \"Eyeshare\", \"LevLnk\", \"KundeLnk\", \"DimAlnk\", \"ProsjektLnk\", \"DateLnk\"}, {\"HovedbokId\", \"KontoId\", \"BilagsNummer\", \"Dato\", \"DimensjonA\", \"DimensjonB\", \"DimensjonC\", \"DimensjonD\", \"ProsjektId\", \"MomsKode\", \"MotkontoType\", \"MotKonto\", \"NettoBelop\", \"TekstKode\", \"Tekst\", \"Periode\", \"Aar\", \"BunkeNummer\", \"RegistreringId\", \"Mengde\", \"KontoLnk\", \"Eyeshare\", \"LevLnk\", \"KundeLnk\", \"DimAlnk\", \"ProsjektLnk\", \"DateLnk\"}),",
                "    HPlink = Table.AddColumn(HentData, \"HPlink\", each Text.BeforeDelimiter([ProsjektId], \"-\"), type text),",
                "    FilterData = Table.SelectRows(HPlink, each ([Aar] <= SisteAar and [Aar] >= SisteAar-AntallAar) and ([ProsjektLnk] <> null and Text.Start(Text.From([KontoId]), 1) > \"2\" )),",
                "    Prosjektliste = Table.SelectColumns(FilterData,{\"HPlink\"}),",
                "    UnikeProsjekter = Table.Distinct(Prosjektliste),",
                "    KunProsjektId = Table.SelectRows(UnikeProsjekter, each ([HPlink] <> \"\")),",
                "    ProsjektPosterAlle = Table.NestedJoin(HPlink,{\"HPlink\"},KunProsjektId,{\"HPlink\"},\"Filtered Rows1\",JoinKind.Inner),",
                "    ProsjektPosterGml = Table.SelectRows(ProsjektPosterAlle, each [Aar] < SisteAar - AntallAar),",
                "    FjernProsjektLink = Table.RemoveColumns(ProsjektPosterGml,{\"Filtered Rows1\", \"DateLnk\"}),",
                "    ResetDato = Table.AddColumn(FjernProsjektLink, \"DateLnk\", each #date((SisteAar)-(AntallAar),1,1)),",
                "    Datasett = Table.Combine({FilterData, ResetDato}),",
                "    VelgKolonner = Table.RemoveColumns(Datasett,{\"InfoEasyId\", \"HovedbokId\", \"DimensjonA\", \"DimensjonB\", \"DimensjonC\", \"DimensjonD\", \"MomsKode\", \"MotkontoType\", \"MotKonto\", \"TekstKode\", \"Tekst\", \"Periode\", \"Aar\", \"BunkeNummer\", \"RegistreringId\", \"Mengde\", \"KontoLnk\", \"DimAlnk\", \"ProsjektLnk\", \"HPlink\"}),",
                "    LevNummer = Table.TransformColumns(VelgKolonner, {{\"LevLnk\", each Text.AfterDelimiter(_, \"-\"), type text}}),",
                "    KundeNr = Table.TransformColumns(LevNummer, {{\"KundeLnk\", each Text.AfterDelimiter(_, \"-\"), type text}}),",
                "    KolonneNavn = Table.RenameColumns(KundeNr,{{\"Dato\", \"PostDato\"}, {\"DateLnk\", \"Dato\"}, {\"NettoBelop\", \"Belop\"}, {\"BilagsNummer\", \"BilagsId\"}, {\"LevLnk\", \"Lev\"}, {\"KundeLnk\", \"Kunde\"}}),",
                "    Datatyper = Table.TransformColumnTypes(KolonneNavn,{{\"BilagsId\", type text}, {\"KontoId\", type text}}),",
                "    NyKundeLnk = Table.AddColumn(Datatyper, \"KundeLnk\", each if Text.Length([Kunde])>0 then Text.From([CompanyId])&\"-\"&Text.From([Kunde]) else null, type text),",
                "    NyLevLnk = Table.AddColumn(NyKundeLnk, \"LevLnk\", each if Text.Length([Lev])>0 then Text.From([CompanyId])&\"-\"&Text.From([Lev]) else null, type text),",
                "    NyProsjektLnk = Table.AddColumn(NyLevLnk, \"ProsjektLnk\", each if [ProsjektId]<> null then Text.From([CompanyId])&\"-\"&Text.From([ProsjektId]) else null, type text),",
                "    NyKontoLnk = Table.AddColumn(NyProsjektLnk, \"KontoLnk\", each if [KontoId]<> null then Text.From([CompanyId])&\"-\"&Text.From([KontoId]) else null, type text),",
                "    fraEngelsk2Norsk = Table.RenameColumns(NyKontoLnk,{{\"CompanyId\", \"SelskapsId\"}}),",
                "    FjernGmlLnkFelt = Table.RemoveColumns(fraEngelsk2Norsk,{\"ProsjektId\", \"Lev\", \"Kunde\", \"KontoId\"}),",
                "    #\"Merged Queries\" = Table.NestedJoin(FjernGmlLnkFelt, {\"OldSelskapsId\", \"BilagsId\"}, SP_ProNummerEndring, {\"CompanyId\", \"GLEntryNo\"}, \"ProNummerEndring\", JoinKind.LeftOuter),",
                "    #\"Expanded ProNummerEndring\" = Table.ExpandTableColumn(#\"Merged Queries\", \"ProNummerEndring\", {\"ProjectId\"}, {\"ProjectId\"}),",
                "    #\"Added Custom\" = Table.AddColumn(#\"Expanded ProNummerEndring\", \"Custom\", each if [ProjectId] = null then [ProsjektLnk] else Text.From([SelskapsId])&\"-\"&Text.From([ProjectId])),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Added Custom\",{\"ProsjektLnk\", \"ProjectId\", \"Company\"}),",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Custom\", \"ProsjektLnk\"}}),",
                "    EyeShareSource = Table.NestedJoin(SQL_EyeShare,{\"FirmaId\"}, SQL_Company,{\"InfoEasyId\"}, \"SelskapsId\",JoinKind.Inner),",
                "    #\"Expanded SelskapsId\" = Table.ExpandTableColumn(EyeShareSource, \"SelskapsId\", {\"CompanyId\"}, {\"CompanyId\"}),",
                "    FilterZeroProId = Table.SelectRows(#\"Expanded SelskapsId\", each ([ProsjektId] <> null and [ProsjektId] <> \"\" and [KontoId] <> null and [KontoId] <> \"\")),",
                "    LevLnk = Table.AddColumn(FilterZeroProId, \"LevLnk\", each if Text.Length([LevId]) > 0 then Text.From([CompanyId])&\"-\"&Text.From([LevId]) else null),",
                "    ProsjektLnk = Table.AddColumn(LevLnk, \"ProsjektLnk\", each if Text.Length([ProsjektId]) > 0 then Text.From([CompanyId])&\"-\"&Text.From([ProsjektId]) else null),",
                "    KontoLnk = Table.AddColumn(ProsjektLnk, \"KontoLnk\", each if Text.Length([KontoId]) > 0 then Text.From([CompanyId])&\"-\"&Text.From([KontoId]) else null),",
                "    RemoveCol = Table.RemoveColumns(KontoLnk,{\"FirmaId\", \"LevId\", \"KontoId\", \"ProsjektId\"}),",
                "    #\"Renamed Columns1\" = Table.RenameColumns(RemoveCol,{{\"EstNetAmount\", \"Belop2\"}, {\"CompanyId\", \"SelskapsId\"}, {\"EyeShare\", \"Eyeshare\"}}),",
                "    #\"Appended Query\" = Table.Combine({#\"Renamed Columns\", #\"Renamed Columns1\"}),",
                "    ORG = Table.TransformColumnTypes(#\"Appended Query\",{{\"SelskapsId\", Int64.Type}, {\"BilagsId\", Int64.Type}, {\"PostDato\", type date}, {\"Belop\", type number}, {\"Eyeshare\", type text}, {\"Dato\", type date}, {\"KundeLnk\", type text}, {\"LevLnk\", type text}, {\"KontoLnk\", type text}, {\"ProsjektLnk\", type text}, {\"FakturaId\", type text}, {\"FakturaDato\", type datetime}, {\"Belop2\", type number}}),",
                "    #\"Filtered Rows\" = Table.SelectRows(ORG, each ([KontoLnk] = \"3-2900\") and ([ProsjektLnk] <> null)),",
                "    #\"Multiplied Column1\" = Table.TransformColumns(#\"Filtered Rows\", {{\"Belop\", each _ * 1, type number}}),",
                "    #\"398\" = Table.ReplaceValue(#\"Multiplied Column1\",\"2900\",\"398\",Replacer.ReplaceText,{\"KontoLnk\"}),",
                "    #\"Multiplied Column\" = Table.TransformColumns(#\"398\", {{\"Belop\", each _ * -1, type number}}),",
                "    #\"399\" = Table.ReplaceValue(#\"Multiplied Column\",\"398\",\"399\",Replacer.ReplaceText,{\"KontoLnk\"}),",
                "    #\"Appended Query1\" = Table.Combine({#\"ORG\", #\"398\", #\"399\"})",
                "in",
                "    #\"Appended Query1\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Selskap",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "SelskapNavn",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "0ff95afe-b924-4d1b-8528-6d5f6d5ac513",
            "sourceColumn": "SelskapNavn",
            "summarizeBy": "none"
          },
          {
            "name": "SelskapsId",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "5bac2892-8a62-4067-82e9-2e333c1b2d89",
            "sourceColumn": "SelskapsId",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "4a42a065-a6f4-47a7-9b1b-ce9a1b46ec5e",
        "measures": [
          {
            "name": "Selskap",
            "expression": "MAX(Selskap[SelskapNavn])",
            "lineageTag": "fc40ce37-4aec-4595-8e53-3096f04bc8d5"
          },
          {
            "name": "User",
            "expression": "USERPRINCIPALNAME()",
            "lineageTag": "0f0b4008-fe4a-40f3-af4a-193dbf6341e4"
          }
        ],
        "partitions": [
          {
            "name": "Selskap-4b2f9948-7c94-4e5a-885c-5f7ee325a4f2",
            "mode": "import",
            "queryGroup": "Dimensjoner",
            "source": {
              "expression": [
                "let",
                "    //SharePoint",
                "/*",
                "    SharePoint = SharePoint.Tables(SharePointSite1, [ApiVersion = 15]),",
                "    Company = SharePoint{[Id=\"c6c05096-82a1-486e-af74-d9aca84f2740\"]}[Items],",
                "    SelectColumns = Table.SelectColumns(Company,{\"Title\", \"CompanyId\"}),",
                "    RenameColumns = Table.RenameColumns(SelectColumns,{{\"Title\", \"Company\"}, {\"CompanyId\", \"SelskapsId\"}}),",
                "*/",
                "",
                "    table1 = \"LU_Companies\",",
                "    sqlDatabase = Sql.Database(SQLserver1, SQLdatabase1),",
                "    sqlTbl1 = sqlDatabase{[Schema=\"dbo\",Item=(table1)]}[Data],",
                "    #\"Filtered Rows\" = Table.SelectRows(sqlTbl1, each [CompanyId] = CompanyId),",
                "",
                "    #\"Renamed Columns\" = Table.RenameColumns(#\"Filtered Rows\",{{\"Company\", \"SelskapNavn\"},{\"CompanyId\", \"SelskapsId\"}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Renamed Columns\",{\"InfoEasyId\"}),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"SelskapNavn\", type text}, {\"SelskapsId\", Int64.Type}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "VelgInnhold",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "fc1b56e6f92c422a8e5ecaf5018becbb"
          }
        ],
        "columns": [
          {
            "name": "Parameter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": false,
            "lineageTag": "2a1aef38-ed73-479e-b57c-fbe072b55e4e",
            "relatedColumnDetails": {
              "groupByColumns": [
                {
                  "groupingColumn": "Parameter Fields"
                }
              ]
            },
            "sortByColumn": "Parameter Order",
            "sourceColumn": "[Value1]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Parameter Fields",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "extendedProperties": [
              {
                "name": "ParameterMetadata",
                "type": "json",
                "value": {
                  "kind": 2,
                  "version": 3
                }
              }
            ],
            "isDataTypeInferred": true,
            "isHidden": true,
            "isNameInferred": false,
            "lineageTag": "feace058-82be-4aef-9221-992833a0743a",
            "sortByColumn": "Parameter Order",
            "sourceColumn": "[Value2]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Parameter Order",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isHidden": true,
            "isNameInferred": false,
            "lineageTag": "6453dee7-9393-45df-933f-fb25a9551752",
            "sourceColumn": "[Value3]",
            "summarizeBy": "sum",
            "type": "calculatedTableColumn"
          }
        ],
        "lineageTag": "4c863a92-88d3-470f-828e-28e27de5118a",
        "partitions": [
          {
            "name": "VelgInnhold",
            "mode": "import",
            "source": {
              "expression": [
                "{",
                "    (\"Delprosjekt\", NAMEOF('Prosjekt'[DelprosjektNummer]), 0),",
                "    (\"Leverandør\", NAMEOF('Leverandører'[LeverandorBeskrivelse]), 1),",
                "    (\"År\", NAMEOF('Kalender'[KortÅr]), 2),",
                "    (\"Mnd\", NAMEOF('Kalender'[KortMnd]), 3)",
                "}"
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "WorkInProgress",
        "annotations": [
          {
            "name": "PBI_NavigationStepName",
            "value": "Navigation"
          },
          {
            "name": "PBI_ResultType",
            "value": "Text"
          }
        ],
        "columns": [
          {
            "name": "WorkInProgress",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "changedProperties": [
              {
                "property": "IsHidden"
              }
            ],
            "dataType": "string",
            "isHidden": true,
            "lineageTag": "4092f65b-d569-46c9-ae62-ba6769091c2b",
            "sourceColumn": "WorkInProgress",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "6d09d89c-531e-41e2-b312-ba3c36d5fd2a",
        "measures": [
          {
            "name": "ProKostEst",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUM(HpPrognose[Kostnader]) ",
            "formatString": "#,0",
            "lineageTag": "f4a42719-ca1d-4354-b143-fed4d97c2c94"
          },
          {
            "name": "ProKostPer",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "CALCULATE (",
              "            SUMX (",
              "                CALCULATETABLE ( VALUES ( Prosjekt[ProsjektNummer] ),Prosjekt[WIPfilter]=1), ",
              "                [Regnskap] / MIN ( Faktorer[Faktor] )",
              "            ),",
              "            Kontoplan[Rapport] = \"Resultat\",Kontoplan[Nivå1]<>\"Inntekter\"   ",
              "        )"
            ],
            "lineageTag": "7914405c-d9a7-4ed7-b184-27cad2ea608d"
          },
          {
            "name": "ProKostYTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "TOTALYTD([ProKostPer],Kalender[Dato])",
            "lineageTag": "9ed291c2-5d40-4e11-8e06-cc5f0a66eb85"
          },
          {
            "name": "ProKostTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "CALCULATE([ProKostPer],FILTER(ALL(Kalender),Kalender[Dato]<=MAX(Kalender[Dato])))",
            "lineageTag": "36e2a056-4b30-45f6-bb08-d3e745ebb79f"
          },
          {
            "name": "ProFremdriftTD",
            "expression": "IF(ISBLANK(DIVIDE([ProKostTD],[ProKostEst])),0,IF(DIVIDE([ProKostTD],[ProKostEst])>1,1,DIVIDE([ProKostTD],[ProKostEst],1)))",
            "formatString": "0.0\\ %;-0.0\\ %;0.0\\ %",
            "lineageTag": "ba365d56-713c-4ea3-a592-3635222de87b"
          },
          {
            "name": "ProInntektEst",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUM(HpPrognose[Inntekter])",
            "formatString": "#,0",
            "lineageTag": "02c77288-7a6c-430a-ac09-68192893b920"
          },
          {
            "name": "ProInntektTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "SUMX(VALUES(Prosjekt[HP Beskrivelse]),[ProInntektEst]*[ProFremdriftTD])",
            "lineageTag": "c7613fd3-43de-4601-ac75-924c60a59a4b"
          },
          {
            "name": "ProInntektPer",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[ProInntektTD]-CALCULATE([ProInntektTD],DATEADD(Kalender[Dato],-1,MONTH))",
            "lineageTag": "b30c5ce4-7153-4eef-a760-f8581f5fa9f1"
          },
          {
            "name": "ProInntektYTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[ProInntektTD] - CALCULATE([ProInntektTD],FILTER(ALL(Kalender),Kalender[År]=YEAR(MAX(Kalender[Dato]))-1),Kalender[MndNo]=12)",
            "lineageTag": "26f59701-c22f-47d8-962e-23d49ac2fda6"
          },
          {
            "name": "WIP",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[ProInntektTD]-[FakturertAkk]+[ForskuddAkk]",
            "formatString": "#,0",
            "lineageTag": "55644b68-a763-4a58-a8fb-8841d52587b3"
          },
          {
            "name": "Inntekter",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[ProInntektPer]",
            "lineageTag": "c4ae5b59-47b7-4544-9d6b-8e5593ec34cf"
          },
          {
            "name": "Inntektstekst",
            "expression": "CONCATENATE(\"Inntekt pr. \",COMBINEVALUES(\"-\",LOWER(SELECTEDVALUE(Kalender[Mnd])),SELECTEDVALUE(Kalender[År])) )",
            "lineageTag": "f54a1036-64c4-4a28-ab2e-d90847c15d33"
          },
          {
            "name": "ORtekst",
            "expression": "\"Ordre\"",
            "lineageTag": "b5e89c35-b53b-479c-91be-7c58f9f7559e"
          },
          {
            "name": "ORteksttotalt",
            "expression": "\"reserve totalt\"",
            "lineageTag": "ed755280-8840-4185-a6b4-b9925fd36457"
          },
          {
            "name": "ORtekstiår",
            "expression": "CONCATENATE(\"reserve for \",SELECTEDVALUE(Kalender[År]))",
            "lineageTag": "f9b000b8-fc9d-4be3-aa4e-e5421cb421fb"
          },
          {
            "name": "Inntektsmåltekst",
            "expression": "CONCATENATE(\"Inntektsmål for \",SELECTEDVALUE(Kalender[År]))",
            "lineageTag": "2fc34985-bd6f-4284-ad02-c58c11321172"
          },
          {
            "name": "OItekstiår",
            "expression": "CONCATENATE(\"inngang i \",SELECTEDVALUE(Kalender[År]))",
            "lineageTag": "95da0423-37df-4680-ae69-927f75b36e8b"
          },
          {
            "name": "ProBidragEst",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "-SUM(HpPrognose[Inntekter])-SUM(HpPrognose[Kostnader])",
            "lineageTag": "5814fb85-f7f4-4856-9250-8b6c7a01c685"
          },
          {
            "name": "ProBidragTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "SUMX(VALUES(Prosjekt[HP Beskrivelse]),[ProInntektEst]*[ProFremdriftTD])-[ProKostTD]",
            "lineageTag": "a2ff0572-8170-452d-a8bd-31eb2e54c5f7"
          },
          {
            "name": "Bidragsreserve",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "[DB Prognose]-[Bidrag]",
            "formatString": "#,0",
            "lineageTag": "ecd2172c-079a-4dd2-b14d-3c6c210615b3"
          },
          {
            "name": "BidragsreserveTY",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "SUMX(VALUES(Prosjekt[HP Beskrivelse]),CALCULATE(IF(YEAR(MAX(HpPrognose[Slutt]))<=YEAR(MAX(Kalender[Dato])),[Bidragsreserve],[Bidragsreserve]*(1-DIVIDE(MAX(HpPrognose[Slutt])-DATE(YEAR(MAX(Kalender[Dato])),12,31),SUM(HpPrognose[Varighet]))))))",
            "lineageTag": "4edce24d-4356-4325-b7d0-ca4fb3e4c349"
          },
          {
            "name": "BRtekst",
            "expression": "\"Bidrags-\"",
            "lineageTag": "8faa57ff-e733-4e42-bad4-adbe7d54aba7"
          },
          {
            "name": "Bidragstekst",
            "expression": "CONCATENATE(\"Bidrag pr. \",COMBINEVALUES(\"-\",LOWER(SELECTEDVALUE(Kalender[Mnd])),SELECTEDVALUE(Kalender[År])) )",
            "lineageTag": "082e76e1-31ef-4eba-93c0-c0ce0390a7b8"
          },
          {
            "name": "Bidragsmåltekst",
            "expression": "CONCATENATE(\"Bidragsmål for \",SELECTEDVALUE(Kalender[År]))",
            "lineageTag": "1e8b5a83-2a52-4b4a-86c6-18365ed45ec4"
          },
          {
            "name": "ProBidragYTD",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "[ProBidragTD] - CALCULATE([ProBidragTD],FILTER(ALL(Kalender),Kalender[År]=YEAR(MAX(Kalender[Dato]))-1),Kalender[MndNo]=12)",
            "lineageTag": "6d4586b6-f08b-48b6-b341-7383e5ff5917"
          },
          {
            "name": "Date1",
            "expression": "CALCULATE(MAX(HpPrognose[Slutt]),ALL(Kalender))",
            "formatString": "General Date",
            "lineageTag": "10f567cd-f7e1-4a64-a230-f344e307c327"
          },
          {
            "name": "Date2",
            "expression": "CALCULATE(MAX(HpPrognose[Varighet]),ALL(Kalender))",
            "formatString": "0",
            "lineageTag": "aa615336-a752-4dc3-8645-acf1bde20b1e"
          },
          {
            "name": "ProFremdriftTDnew",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": "DIVIDE([ProKostTD],[ProKostEst],0)",
            "lineageTag": "815bd19a-de77-4391-afcf-bd8c499160e8"
          },
          {
            "name": "1530",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUMX(VALUES(Prosjekt[HP Beskrivelse]),if([VIAakkumulert] > 0,  [VIAakkumulert]))",
            "formatString": "#,0",
            "lineageTag": "2f508374-c84a-403f-8e26-fad2be90f11d"
          },
          {
            "name": "2965",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "SUMX(VALUES(Prosjekt[HP Beskrivelse]),if([VIAakkumulert] < 0,[VIAakkumulert]))",
            "formatString": "#,0",
            "lineageTag": "bb95dcfa-f412-40fb-b8a2-49dbb4702417"
          },
          {
            "name": "3990",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDecimal\":true}"
              }
            ],
            "expression": "-[2965]-[1530]",
            "formatString": "#,0",
            "lineageTag": "ce13237f-e7a0-4cc6-bbdf-8559fa0c0104"
          }
        ],
        "partitions": [
          {
            "name": "WorkInProgress-14aa3fe9-0580-4e49-9c64-6cf18e41b73b",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = \"\"",
                "in",
                "    Source"
              ],
              "type": "m"
            }
          }
        ]
      }
    ]
  }
}